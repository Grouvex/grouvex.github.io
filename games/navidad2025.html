<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Sitio web oficial de Grouvex Studios, una organizaci√≥n que cuenta con Sello Discogr√°fico, Dise√±o, entre otros.">
    <meta property="og:title" content="Una Navidad Resplandeciente - Grouvex Studioss">
    <meta property="og:description" content="Sitio web oficial de Grouvex Studios, una organizaci√≥n que cuenta con Sello Discogr√°fico, Dise√±o, entre otros.">
    <meta property="og:image" content="../img/GROUVEX.png">
    <meta name="keywords" content="Grouvex, M√∫sica, Grouvex Studios, Grouvex's Projects"><meta name="author" content="Grouvex Studios"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#hexcode"><meta property="og:url" content="https://grouvex.com/"><meta property="og:type" content="website"><meta property="og:locale" content="es_ES"><link rel="canonical" href="https://grouvex.com/"><link rel="icon" href="../img/GROUVEX.png" type="image/x-icon"><meta property="og:site_name" content="Grouvex Studios">
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script><script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-database.js"></script><script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    <link rel="stylesheet" href="../index.css"><link rel="stylesheet" href="../temas.css">
    <script src="../time.js"></script></script><script type="module" src="../abc.js"></script><script src="../index.js"></script>
    <script src="../jquery-3.5.1.min.js"></script>
        <script> 
            document.addEventListener("DOMContentLoaded", function() { 
                $("#menuG").load("../menuG.html");$("#menuE").load("../menuE.html");$("#menuT").load("../menuT.html");$("#menuU").load("../menuU.html");
                $("#footer").load("../footer.html"); 
                $("#news").load("../news.html"); $("#tosypp").load("../tosypp.html");
            });
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Una Navidad Resplandeciente - Grouvex Studios</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a3a, #0d1b2a);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .snowflakes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .snowflake {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0.8;
            animation: fall linear infinite;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh);
            }
        }

        header {
            text-align: center;
            padding: 2rem 1rem;
            background: rgba(200, 16, 46, 0.8);
            margin-bottom: 2rem;
            position: relative;
            z-index: 2;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            color: #FFD700;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #f0f0f0;
            max-width: 800px;
            margin: 0 auto;
        }

        .games-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            padding: 0 1.5rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 2;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .game-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.3);
        }

        .game-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-title {
            font-size: 1.4rem;
            margin-bottom: 0.5rem;
            color: #FFD700;
        }

        .game-description {
            font-size: 0.9rem;
            color: #e0e0e0;
            line-height: 1.4;
        }

        .game-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            width: 90%;
            max-width: 800px;
            border-radius: 15px;
            padding: 2rem;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #fff;
            background: rgba(0, 0, 0, 0.3);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-area {
            margin-top: 1.5rem;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .game-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        button {
            background: #c8102e;
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        button:hover {
            background: #a00d26;
            transform: translateY(-3px);
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        footer {
            text-align: center;
            padding: 2rem;
            margin-top: 2rem;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
        }

        /* Puzzle Game Styles */
        .puzzle-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            width: 300px;
            height: 300px;
            margin: 0 auto;
        }

        .puzzle-piece {
            width: 100px;
            height: 100px;
            background-size: 300px 300px;
            cursor: pointer;
            border: 1px solid #fff;
        }

        /* Quiz Game Styles */
        .quiz-container {
            width: 100%;
            max-width: 600px;
        }

        .quiz-question {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .quiz-option {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Maze Game Styles */
        .maze-container {
            display: grid;
            grid-template-columns: repeat(10, 30px);
            grid-template-rows: repeat(10, 30px);
            gap: 2px;
            margin: 0 auto;
        }

        .maze-cell {
            width: 30px;
            height: 30px;
            background: #2a5298;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 3px;
        }

        .maze-wall {
            background: #1a2a3a;
        }

        .maze-player {
            background: #FFD700;
            border-radius: 50%;
            width: 20px;
            height: 20px;
        }

        .maze-goal {
            background: #c8102e;
            border-radius: 50%;
            width: 20px;
            height: 20px;
        }

        /* Gift Toss Game Styles */
        .toss-container {
            position: relative;
            width: 100%;
            height: 400px;
            background: linear-gradient(to bottom, #1e3c72, #2a5298);
            border-radius: 10px;
            overflow: hidden;
        }

        .chimney {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 120px;
            background: #333;
        }

        .gift {
            position: absolute;
            width: 40px;
            height: 40px;
            background: #c8102e;
            border-radius: 5px;
            cursor: pointer;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .games-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .modal-content {
                width: 95%;
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <a href="https://grouvex.github.io/"> <div class="img-container" loading="lazy"></div></a> 
        <span style="font-family: Times New Roman;color:white;box-shadow: 0 0 10px gold;width:100%">
            <nav>
                <span id="menuG"></span>
                <span id="menuT"></span>
                <span id="menuU"></span>
            </nav>
        </span>
    </header>
    <!-- Anuncio -->
    <div id="news"></div>
    <div class="snowflakes" id="snowflakes"></div>

    <header>
        <h1>Una Navidad Resplandeciente</h1>
        <p class="subtitle">Disfruta de estos divertidos juegos navide√±os. ¬°Haz clic en cualquier juego para comenzar la diversi√≥n!</p>
    </header>

    <div class="games-container">
        <!-- Juego 2: Rompecabezas Deslizante -->
        <div class="game-card" data-game="puzzle">
            <div class="game-icon">üß©</div>
            <h3 class="game-title">Rompecabezas Navide√±o</h3>
            <p class="game-description">Arma la imagen navide√±a deslizando las piezas. ¬°Completa el puzzle antes de que se acabe el tiempo!</p>
        </div>

        <!-- Juego 3: Adivina el Regalo -->
        <div class="game-card" data-game="gift">
            <div class="game-icon">üéÅ</div>
            <h3 class="game-title">Adivina el Regalo</h3>
            <p class="game-description">¬øPodr√°s adivinar qu√© hay dentro de los regalos? ¬°Escucha los sonidos y usa las pistas!</p>
        </div>

        <!-- Juego 4: Decoraci√≥n del √Årbol -->
        <div class="game-card" data-game="tree">
            <div class="game-icon">üéÑ</div>
            <h3 class="game-title">Decora el √Årbol</h3>
            <p class="game-description">Decora el √°rbol de Navidad con los adornos m√°s bonitos. ¬°S√© creativo y divi√©rtete!</p>
        </div>

        <!-- Juego 5: Carrera de Trineos -->
        <div class="game-card" data-game="sleigh">
            <div class="game-icon">üõ∑</div>
            <h3 class="game-title">Carrera de Trineos</h3>
            <p class="game-description">Ayuda a Santa a entregar regalos esquivando obst√°culos. ¬°Recolecta estrellas para ganar puntos!</p>
        </div>

        <!-- Juego 6: Sim√≥n Dice Navide√±o -->
        <div class="game-card" data-game="simon">
            <div class="game-icon">üî¥</div>
            <h3 class="game-title">Sim√≥n Dice Navide√±o</h3>
            <p class="game-description">Memoriza y repite la secuencia de luces navide√±as. ¬°Cada nivel es m√°s dif√≠cil!</p>
        </div>

        <!-- Juego 7: B√∫squeda de Objetos -->
        <div class="game-card" data-game="search">
            <div class="game-icon">üîç</div>
            <h3 class="game-title">B√∫squeda Navide√±a</h3>
            <p class="game-description">Encuentra todos los objetos navide√±os escondidos en la escena antes de que se acabe el tiempo.</p>
        </div>

        <!-- Juego 8: Lanzamiento de Regalos -->
        <div class="game-card" data-game="toss">
            <div class="game-icon">üéØ</div>
            <h3 class="game-title">Lanza los Regalos</h3>
            <p class="game-description">Lanza los regalos por la chimenea con la potencia y √°ngulo correctos. ¬°Punt√∫a en el blanco!</p>
        </div>

        <!-- Juego 9: Quiz Navide√±o -->
        <div class="game-card" data-game="quiz">
            <div class="game-icon">‚ùì</div>
            <h3 class="game-title">Quiz Navide√±o</h3>
            <p class="game-description">Pon a prueba tus conocimientos sobre la Navidad. ¬°Responde correctamente para ganar puntos!</p>
        </div>

        <!-- Juego 11: Conecta los Puntos -->
        <div class="game-card" data-game="connect">
            <div class="game-icon">‚úèÔ∏è</div>
            <h3 class="game-title">Conecta los Puntos</h3>
            <p class="game-description">Conecta los puntos en orden para descubrir la imagen navide√±a oculta. ¬°Sorpr√©ndete con el resultado!</p>
        </div>

        <!-- Juego 12: Rompe los Adornos -->
        <div class="game-card" data-game="break">
            <div class="game-icon">üí•</div>
            <h3 class="game-title">Rompe los Adornos</h3>
            <p class="game-description">Rompe todos los adornos navide√±os con la bola. ¬°Cuidado con no perderla!</p>
        </div>

        <!-- Juego 13: Laberinto Navide√±o -->
        <div class="game-card" data-game="maze">
            <div class="game-icon">üß≠</div>
            <h3 class="game-title">Laberinto Navide√±o</h3>
            <p class="game-description">Gu√≠a a Santa a trav√©s del laberinto para que pueda entregar todos los regalos. ¬°Encuentra la salida!</p>
        </div>

        <!-- Juego 14: Emparejamiento de Calcetines -->
        <div class="game-card" data-game="socks">
            <div class="game-icon">üß¶</div>
            <h3 class="game-title">Empareja los Calcetines</h3>
            <p class="game-description">Encuentra los pares de calcetines navide√±os iguales. ¬°Hazlo r√°pido antes de que se acabe el tiempo!</p>
        </div>

        <!-- Juego 15: Canto de Villancicos -->
        <div class="game-card" data-game="carols">
            <div class="game-icon">üéµ</div>
            <h3 class="game-title">Canto de Villancicos</h3>
            <p class="game-description">Sigue el ritmo de los villancicos navide√±os. ¬°Presiona las teclas en el momento correcto!</p>
        </div>
    </div>

    <!-- Modal para los juegos -->
    <div class="game-modal" id="gameModal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h2 id="modalTitle">Juego Navide√±o</h2>
            <div class="game-stats">
                <div id="score">Puntos: 0</div>
                <div id="timer">Tiempo: 60s</div>
                <div id="lives">Vidas: 3</div>
            </div>
            <div class="game-area" id="gameArea">
                <!-- Aqu√≠ se cargar√° el juego seleccionado -->
                <p>Selecciona un juego para comenzar</p>
            </div>
            <div class="game-controls">
                <button id="startBtn">Comenzar</button>
                <button id="resetBtn">Reiniciar</button>
                <button id="hintBtn">Pista</button>
            </div>
        </div>
    </div>

    <footer>
        <p>¬°Felices Fiestas! Que esta Navidad est√© llena de alegr√≠a y diversi√≥n.</p>
        <p>Una Navidad Resplandeciente - 2023</p>
    </footer>

    <script>
        // Crear efecto de nieve
        function createSnowflakes() {
            const snowflakesContainer = document.getElementById('snowflakes');
            const snowflakeCount = 50;
            
            for (let i = 0; i < snowflakeCount; i++) {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                
                // Tama√±o aleatorio
                const size = Math.random() * 10 + 5;
                snowflake.style.width = `${size}px`;
                snowflake.style.height = `${size}px`;
                
                // Posici√≥n inicial aleatoria
                snowflake.style.left = `${Math.random() * 100}vw`;
                
                // Duraci√≥n de animaci√≥n aleatoria
                const duration = Math.random() * 10 + 5;
                snowflake.style.animationDuration = `${duration}s`;
                
                // Retraso aleatorio
                snowflake.style.animationDelay = `${Math.random() * 5}s`;
                
                snowflakesContainer.appendChild(snowflake);
            }
        }

        // Modal y juego
        document.addEventListener('DOMContentLoaded', function() {
            createSnowflakes();
            
            const gameCards = document.querySelectorAll('.game-card');
            const gameModal = document.getElementById('gameModal');
            const closeModal = document.getElementById('closeModal');
            const modalTitle = document.getElementById('modalTitle');
            const gameArea = document.getElementById('gameArea');
            const startBtn = document.getElementById('startBtn');
            const resetBtn = document.getElementById('resetBtn');
            const hintBtn = document.getElementById('hintBtn');
            const scoreDisplay = document.getElementById('score');
            const timerDisplay = document.getElementById('timer');
            const livesDisplay = document.getElementById('lives');
            
            let currentGame = '';
            let gameActive = false;
            let score = 0;
            let timeLeft = 60;
            let lives = 3;
            let timerInterval;
            
            // Abrir modal al hacer clic en un juego
            gameCards.forEach(card => {
                card.addEventListener('click', function() {
                    currentGame = this.getAttribute('data-game');
                    modalTitle.textContent = this.querySelector('.game-title').textContent;
                    gameModal.style.display = 'flex';
                    resetGame();
                    loadGame(currentGame);
                });
            });
            
            // Cerrar modal
            closeModal.addEventListener('click', function() {
                gameModal.style.display = 'none';
                stopGame();
            });
            
            // Cerrar modal al hacer clic fuera
            window.addEventListener('click', function(event) {
                if (event.target === gameModal) {
                    gameModal.style.display = 'none';
                    stopGame();
                }
            });
            
            // Botones de control
            startBtn.addEventListener('click', startGame);
            resetBtn.addEventListener('click', resetGame);
            hintBtn.addEventListener('click', giveHint);
            
            // Funciones del juego
            function loadGame(gameType) {
                gameArea.innerHTML = '';
                
                switch(gameType) {
                    case 'puzzle':
                        loadPuzzleGame();
                        break;
                    case 'gift':
                        loadGiftGame();
                        break;
                    case 'tree':
                        loadTreeGame();
                        break;
                    case 'sleigh':
                        loadSleighGame();
                        break;
                    case 'simon':
                        loadSimonGame();
                        break;
                    case 'search':
                        loadSearchGame();
                        break;
                    case 'toss':
                        loadTossGame();
                        break;
                    case 'quiz':
                        loadQuizGame();
                        break;
                    case 'connect':
                        loadConnectGame();
                        break;
                    case 'break':
                        loadBreakGame();
                        break;
                    case 'maze':
                        loadMazeGame();
                        break;
                    case 'socks':
                        loadSocksGame();
                        break;
                    case 'carols':
                        loadCarolsGame();
                        break;
                }
            }
            
            function startGame() {
                if (gameActive) return;
                
                gameActive = true;
                startBtn.disabled = true;
                startTimer();
                
                // Aqu√≠ ir√≠a la l√≥gica espec√≠fica para iniciar cada juego
                switch(currentGame) {
                    case 'puzzle':
                        isPuzzleActive = true;
                        break;
                    case 'gift':
                        startGiftGame();
                        break;
                    case 'tree':
                        startTreeGame();
                    case 'simon':
                        startSimonGame();
                        break;
                    case 'search':
                        startSearchGame();
                        break;
                    case 'toss':
                        startTossGame();
                        break;
                    case 'connect':
                        startConnectGame();
                        break;
                    // ... otros casos para cada juego
                }
            }
            
            function resetGame() {
                stopGame();
                score = 0;
                timeLeft = 60;
                lives = 3;
                updateDisplay();
                startBtn.disabled = false;
                
                // Reset espec√≠fico para cada juego
                if (currentGame === 'puzzle') {
                    // El puzzle se reinicia autom√°ticamente al cargar
                } else if (currentGame === 'gift') {
                    // El juego de regalos se reinicia autom√°ticamente al cargar
                } else if (currentGame === 'tree') {
                    // El juego del √°rbol se reinicia autom√°ticamente al cargar
                } else if (currentGame === 'simon') {
                    // El juego Sim√≥n se reinicia autom√°ticamente al cargar
                } else if (currentGame === 'search') {
                    // El juego Sim√≥n se reinicia autom√°ticamente al cargar
                } else if (currentGame === 'toss') {
                    // El juego Sim√≥n se reinicia autom√°ticamente al cargar
                } else if (currentGame === 'connect') {
                    // El juego Sim√≥n se reinicia autom√°ticamente al cargar
                }
            }
            
function stopGame() {
    gameActive = false;
    clearInterval(timerInterval);
    
    // Detener juegos espec√≠ficos
    if (currentGame === 'puzzle') {
        stopPuzzleGame();
    } else if (currentGame === 'gift') {
        stopGiftGame();
    } else if (currentGame === 'tree') {
        stopTreeGame();
    } else if (currentGame === 'simon') {
        stopSimonGame(); 
    } else if (currentGame === 'search') {
        stopSearchGame(); 
    } else if (currentGame === 'toss') {
        stopTossGame(); 
    } else if (currentGame === 'connect') {
        stopConnectGame(); 
    }
}
            
            function startTimer() {
                clearInterval(timerInterval);
                timerInterval = setInterval(function() {
                    timeLeft--;
                    updateDisplay();
                    
                    if (timeLeft <= 0) {
                        endGame();
                    }
                }, 1000);
            }
            
            function updateDisplay() {
                scoreDisplay.textContent = `Puntos: ${score}`;
                timerDisplay.textContent = `Tiempo: ${timeLeft}s`;
                livesDisplay.textContent = `Vidas: ${lives}`;
            }
            
            function endGame() {
                stopGame();
                alert(`¬°Juego terminado! Tu puntuaci√≥n final es: ${score}`);
            }
            
            function giveHint() {
                if (!gameActive) return;
                
                // L√≥gica para dar pistas seg√∫n el juego
                switch(currentGame) {
                    case 'puzzle':
                        givePuzzleHint();
                        break;
                    case 'gift':
                        playGiftHint();
                        break;
                    case 'tree':
                        giveTreeHint();
                        break;
                    case 'simon':
                        showSimonHint();
                        break;
                    case 'search':
                        showSearchHint();
                        break;
                    case 'toss':
                        showTossHint();
                        break;
                    case 'connect':
                        showConnectHint();
                        break;
                    default:
                        alert("¬°Esta es una pista! Intenta de nuevo.");
                }
            }
            
            // Funciones de carga de juegos
// =============================================
// C√ìDIGO DEL PUZZLE NAVIDE√ëO CON EMOJIS
// =============================================

// Variables globales para el juego de puzzle
let puzzlePieces = [];
let emptyPieceIndex = 8;
let puzzleMoveCount = 0;
let puzzleSolved = false;
let puzzleTimer;
let puzzleTime = 0;
let isPuzzleActive = false;

// Emojis navide√±os para el puzzle
const christmasEmojis = ['üéÑ', 'üéÖ', 'ü¶å', 'üéÅ', '‚≠ê', 'üîî', '‚ùÑÔ∏è', 'üïØÔ∏è', ''];

// Funci√≥n para cargar el juego de puzzle
function loadPuzzleGame() {
    gameArea.innerHTML = `
        <div class="puzzle-game-container">
            <h3>üß© Puzzle Navide√±o</h3>
            <p>Haz clic en los emojis adyacentes al espacio vac√≠o para moverlos. ¬°Ordena los emojis!</p>
            
            <div class="puzzle-target">
                <strong>Objetivo:</strong>
                <div class="target-emojis">
                    ${christmasEmojis.slice(0, -1).map(emoji => `<span>${emoji}</span>`).join('')}
                </div>
            </div>
            
            <div class="puzzle-container" id="puzzleContainer"></div>
            
            <div class="puzzle-stats">
                <div class="stat">
                    <span class="stat-label">Movimientos:</span>
                    <span id="puzzleMoveCount" class="stat-value">0</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Tiempo:</span>
                    <span id="puzzleTimeDisplay" class="stat-value">0s</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Estado:</span>
                    <span id="puzzleStatus" class="stat-value">Jugando</span>
                </div>
            </div>
            
            <div class="puzzle-controls">
                <button id="puzzleShuffleBtn" class="puzzle-btn">üîÄ Mezclar</button>
                <button id="puzzleHintBtn" class="puzzle-btn">‚ùì Pista</button>
            </div>
        </div>
    `;
    
    initializePuzzle();
    setupPuzzleEvents();
    addPuzzleStyles();
}

// Inicializar el puzzle
function initializePuzzle() {
    const puzzleContainer = document.getElementById('puzzleContainer');
    puzzleContainer.innerHTML = '';
    puzzlePieces = [];
    
    // Crear piezas del puzzle con emojis
    for (let i = 0; i < 9; i++) {
        const piece = document.createElement('div');
        piece.className = 'puzzle-piece';
        piece.dataset.index = i;
        piece.dataset.correctIndex = i;
        
        if (i !== 8) {
            piece.textContent = christmasEmojis[i];
            piece.classList.add('emoji-piece');
        } else {
            piece.classList.add('empty');
            piece.innerHTML = '‚¨§'; // Punto para indicar espacio vac√≠o
        }
        
        puzzleContainer.appendChild(piece);
        puzzlePieces.push(piece);
    }
    
    // Mezclar las piezas
    shufflePuzzle();
    
    // Reiniciar contadores
    puzzleMoveCount = 0;
    puzzleSolved = false;
    puzzleTime = 0;
    isPuzzleActive = true;
    updatePuzzleStats();
    updatePuzzleStatus();
    
    // Iniciar temporizador del puzzle
    startPuzzleTimer();
}

// Mezclar el puzzle
function shufflePuzzle() {
    // Realizar movimientos aleatorios v√°lidos
    const shuffleMoves = 50;
    
    for (let i = 0; i < shuffleMoves; i++) {
        const adjacentPieces = getAdjacentPieces(emptyPieceIndex);
        const randomIndex = adjacentPieces[Math.floor(Math.random() * adjacentPieces.length)];
        swapPieces(randomIndex, emptyPieceIndex);
    }
    
    puzzleMoveCount = 0;
    updatePuzzleStats();
}

// Obtener piezas adyacentes
function getAdjacentPieces(index) {
    const adjacent = [];
    const row = Math.floor(index / 3);
    const col = index % 3;
    
    if (row > 0) adjacent.push(index - 3);
    if (row < 2) adjacent.push(index + 3);
    if (col > 0) adjacent.push(index - 1);
    if (col < 2) adjacent.push(index + 1);
    
    return adjacent;
}

// Intercambiar piezas
function swapPieces(index1, index2) {
    const piece1 = puzzlePieces[index1];
    const piece2 = puzzlePieces[index2];
    
    // Intercambiar posiciones en el array
    [puzzlePieces[index1], puzzlePieces[index2]] = [puzzlePieces[index2], puzzlePieces[index1]];
    
    // Intercambiar contenido visual
    const tempContent = piece1.innerHTML;
    const tempClass = piece1.className;
    
    piece1.innerHTML = piece2.innerHTML;
    piece1.className = piece2.className;
    
    piece2.innerHTML = tempContent;
    piece2.className = tempClass;
    
    // Actualizar √≠ndices
    piece1.dataset.index = index2;
    piece2.dataset.index = index1;
    
    // Actualizar posici√≥n vac√≠a
    if (piece1.classList.contains('empty')) {
        emptyPieceIndex = index2;
    } else if (piece2.classList.contains('empty')) {
        emptyPieceIndex = index1;
    }
}

// Mover pieza
function movePuzzlePiece(clickedIndex) {
    if (puzzleSolved || !isPuzzleActive) return;
    
    const adjacentPieces = getAdjacentPieces(emptyPieceIndex);
    
    if (adjacentPieces.includes(clickedIndex)) {
        swapPieces(clickedIndex, emptyPieceIndex);
        puzzleMoveCount++;
        updatePuzzleStats();
        
        // Efecto visual
        animatePieceMove(clickedIndex);
        
        // Verificar si est√° resuelto
        checkPuzzleSolved();
    }
}

// Animaci√≥n al mover pieza
function animatePieceMove(pieceIndex) {
    const piece = puzzlePieces[pieceIndex];
    piece.style.transform = 'scale(0.9)';
    
    setTimeout(() => {
        piece.style.transform = 'scale(1)';
    }, 150);
}

// Configurar eventos del puzzle
function setupPuzzleEvents() {
    const puzzleContainer = document.getElementById('puzzleContainer');
    const shuffleBtn = document.getElementById('puzzleShuffleBtn');
    const hintBtn = document.getElementById('puzzleHintBtn');
    
    // Evento para clic en piezas
    puzzleContainer.addEventListener('click', (e) => {
        const clickedPiece = e.target.closest('.puzzle-piece');
        if (!clickedPiece || clickedPiece.classList.contains('empty')) return;
        
        const clickedIndex = parseInt(clickedPiece.dataset.index);
        movePuzzlePiece(clickedIndex);
    });
    
    // Bot√≥n mezclar
    shuffleBtn.addEventListener('click', () => {
        shufflePuzzle();
        puzzleSolved = false;
        isPuzzleActive = true;
        updatePuzzleStatus();
    });
    
    // Bot√≥n pista
    hintBtn.addEventListener('click', givePuzzleHint);
    
    // Controles de teclado
    document.addEventListener('keydown', handlePuzzleKeys);
}

// Controles de teclado para el puzzle
function handlePuzzleKeys(e) {
    if (!isPuzzleActive || puzzleSolved) return;
    
    let pieceToMove = -1;
    const row = Math.floor(emptyPieceIndex / 3);
    const col = emptyPieceIndex % 3;
    
    switch(e.key) {
        case 'ArrowUp': if (row < 2) pieceToMove = emptyPieceIndex + 3; break;
        case 'ArrowDown': if (row > 0) pieceToMove = emptyPieceIndex - 3; break;
        case 'ArrowLeft': if (col < 2) pieceToMove = emptyPieceIndex + 1; break;
        case 'ArrowRight': if (col > 0) pieceToMove = emptyPieceIndex - 1; break;
    }
    
    if (pieceToMove !== -1) {
        movePuzzlePiece(pieceToMove);
        e.preventDefault();
    }
}

// Dar pista en el puzzle
function givePuzzleHint() {
    if (puzzleSolved || !isPuzzleActive) return;
    
    // Encontrar una pieza que no est√© en su posici√≥n
    const misplacedPiece = puzzlePieces.find((piece, index) => {
        return !piece.classList.contains('empty') && 
               parseInt(piece.dataset.index) !== parseInt(piece.dataset.correctIndex);
    });
    
    if (misplacedPiece) {
        const pieceIndex = parseInt(misplacedPiece.dataset.index);
        misplacedPiece.style.boxShadow = '0 0 15px yellow';
        misplacedPiece.style.transition = 'box-shadow 0.3s ease';
        
        setTimeout(() => {
            misplacedPiece.style.boxShadow = '';
        }, 1000);
    }
}

// Verificar si el puzzle est√° resuelto
function checkPuzzleSolved() {
    const isSolved = puzzlePieces.every((piece, index) => {
        return parseInt(piece.dataset.index) === parseInt(piece.dataset.correctIndex);
    });
    
    if (isSolved && !puzzleSolved) {
        puzzleSolved = true;
        isPuzzleActive = false;
        clearInterval(puzzleTimer);
        
        // Actualizar puntuaci√≥n global
        score += 100; // 100 puntos por completar el puzzle
        updateDisplay();
        
        setTimeout(() => {
            celebratePuzzleWin();
            updatePuzzleStatus();
            alert(`üéâ ¬°Felicidades! üéâ\n\nCompletaste el puzzle en:\n${puzzleMoveCount} movimientos\n${puzzleTime} segundos\n\n+100 puntos!`);
        }, 500);
    }
    
    return isSolved;
}

// Celebrar victoria en el puzzle
function celebratePuzzleWin() {
    puzzlePieces.forEach((piece, index) => {
        if (!piece.classList.contains('empty')) {
            setTimeout(() => {
                piece.style.animation = 'celebrate 0.5s ease-in-out';
                piece.style.boxShadow = '0 0 20px gold';
            }, index * 100);
        }
    });
}

// Actualizar estad√≠sticas del puzzle
function updatePuzzleStats() {
    const moveCountElement = document.getElementById('puzzleMoveCount');
    const puzzleTimeElement = document.getElementById('puzzleTimeDisplay');
    
    if (moveCountElement) moveCountElement.textContent = puzzleMoveCount;
    if (puzzleTimeElement) puzzleTimeElement.textContent = puzzleTime;
}

// Actualizar estado del puzzle
function updatePuzzleStatus() {
    const statusElement = document.getElementById('puzzleStatus');
    if (statusElement) {
        statusElement.textContent = puzzleSolved ? 'üéâ ¬°Completado!' : 'üéÆ Jugando';
        statusElement.style.color = puzzleSolved ? '#4CAF50' : '#FFD700';
    }
}

// Iniciar temporizador del puzzle
function startPuzzleTimer() {
    clearInterval(puzzleTimer);
    puzzleTimer = setInterval(() => {
        if (isPuzzleActive && !puzzleSolved) {
            puzzleTime++;
            updatePuzzleStats();
        }
    }, 1000);
}

// Detener juego de puzzle
function stopPuzzleGame() {
    clearInterval(puzzleTimer);
    isPuzzleActive = false;
    document.removeEventListener('keydown', handlePuzzleKeys);
}

// Agregar estilos CSS para el puzzle
function addPuzzleStyles() {
    if (document.getElementById('puzzle-emoji-styles')) return;
    
    const style = document.createElement('style');
    style.id = 'puzzle-emoji-styles';
    style.textContent = `
        .puzzle-game-container {
            text-align: center;
            padding: 20px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .puzzle-target {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #FFD700;
        }
        
        .target-emojis {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .target-emojis span {
            font-size: 2rem;
            padding: 5px;
        }
        
        .puzzle-container {
            display: grid;
            grid-template-columns: repeat(3, 80px);
            grid-template-rows: repeat(3, 80px);
            gap: 5px;
            margin: 20px auto;
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 15px;
            border: 3px solid #c8102e;
        }
        
        .puzzle-piece {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #ddd;
            user-select: none;
        }
        
        .puzzle-piece.emoji-piece:hover {
            transform: scale(1.05);
            border-color: #FFD700;
            box-shadow: 0 5px 15px rgba(255,215,0,0.3);
        }
        
        .puzzle-piece.empty {
            background: rgba(26, 42, 58, 0.7);
            color: #666;
            cursor: default;
            font-size: 1.5rem;
        }
        
        .puzzle-piece.empty:hover {
            transform: none;
            box-shadow: none;
        }
        
        .puzzle-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 25px;
            min-width: 120px;
        }
        
        .stat-label {
            display: block;
            font-size: 0.9rem;
            color: #ccc;
        }
        
        .stat-value {
            display: block;
            font-size: 1.3rem;
            font-weight: bold;
            color: #FFD700;
        }
        
        .puzzle-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .puzzle-btn {
            background: linear-gradient(135deg, #c8102e, #a00d26);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 120px;
        }
        
        .puzzle-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(200, 16, 46, 0.4);
        }
        
        @keyframes celebrate {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
    `;
    document.head.appendChild(style);
}
            
            function loadQuizGame() {
                gameArea.innerHTML = `
                    <div class="quiz-container">
                        <h3>Quiz Navide√±o</h3>
                        <div class="quiz-question" id="quizQuestion">¬øEn qu√© pa√≠s se origin√≥ la tradici√≥n del √°rbol de Navidad?</div>
                        <div class="quiz-options">
                            <div class="quiz-option">Alemania</div>
                            <div class="quiz-option">Estados Unidos</div>
                            <div class="quiz-option">Italia</div>
                            <div class="quiz-option">M√©xico</div>
                        </div>
                    </div>
                `;
            }
            
            function loadMazeGame() {
                gameArea.innerHTML = `
                    <h3>Laberinto Navide√±o</h3>
                    <p>Usa las flechas del teclado para guiar a Santa</p>
                    <div class="maze-container">
                        <!-- Aqu√≠ ir√≠a el laberinto generado din√°micamente -->
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <div class="maze-cell maze-wall"></div>
                        <!-- ... m√°s celdas del laberinto -->
                        <div class="maze-cell"><div class="maze-player"></div></div>
                        <div class="maze-cell maze-wall"></div>
                        <!-- ... m√°s celdas -->
                        <div class="maze-cell"><div class="maze-goal"></div></div>
                    </div>
                `;
            }
            
            // Las dem√°s funciones de carga de juegos seguir√≠an un patr√≥n similar
            
// =============================================
// JUEGO "ADIVINA EL REGALO"
// =============================================

// Variables globales para el juego de adivinar regalos
let giftGameScore = 0;
let giftGameLives = 3;
let giftGameTimer;
let giftGameTimeLeft = 60;
let giftGameActive = false;
let currentGift = null;
let gifts = [];
let revealedGifts = [];

// Tipos de regalos con sus propiedades
const giftTypes = [
    { emoji: 'üéÆ', name: 'Videojuego', sound: 'beep', points: 20 },
    { emoji: 'üìö', name: 'Libro', sound: 'page', points: 15 },
    { emoji: 'üß∏', name: 'Peluche', sound: 'squeak', points: 10 },
    { emoji: 'üëï', name: 'Ropa', sound: 'rustle', points: 12 },
    { emoji: 'üç´', name: 'Chocolate', sound: 'unwrap', points: 8 },
    { emoji: 'üé®', name: 'Pinturas', sound: 'shake', points: 18 },
    { emoji: '‚öΩ', name: 'Pelota', sound: 'bounce', points: 14 },
    { emoji: 'üß©', name: 'Rompecabezas', sound: 'clack', points: 16 }
];

// Funci√≥n para cargar el juego "Adivina el Regalo"
function loadGiftGame() {
    gameArea.innerHTML = `
        <div class="gift-game-container">
            <h3>üéÅ Adivina el Regalo</h3>
            <p>Haz clic en los regalos para escuchar pistas y adivinar qu√© hay dentro. ¬°Cuidado con los regalos trampa!</p>
            
            <div class="gift-game-info">
                <div class="gift-stats">
                    <div class="gift-stat">
                        <span class="stat-label">Puntos:</span>
                        <span id="giftScore" class="stat-value">0</span>
                    </div>
                    <div class="gift-stat">
                        <span class="stat-label">Vidas:</span>
                        <span id="giftLives" class="stat-value">3</span>
                    </div>
                    <div class="gift-stat">
                        <span class="stat-label">Tiempo:</span>
                        <span id="giftTime" class="stat-value">60s</span>
                    </div>
                </div>
                
                <div class="current-gift" id="currentGiftDisplay">
                    <p>¬°Haz clic en un regalo para comenzar!</p>
                </div>
            </div>
            
            <div class="gifts-container" id="giftsContainer"></div>
            
            <div class="gift-options" id="giftOptions"></div>
            
            <div class="gift-controls">
                <button id="giftStartBtn" class="gift-btn">üéØ Comenzar</button>
                <button id="giftHintBtn" class="gift-btn">üîä Repetir Pista</button>
                <button id="giftSkipBtn" class="gift-btn">‚è≠Ô∏è Saltar</button>
            </div>
            
            <div class="gift-message" id="giftMessage"></div>
        </div>
    `;
    
    initializeGiftGame();
    setupGiftGameEvents();
    addGiftGameStyles();
}

// Inicializar el juego de regalos
function initializeGiftGame() {
    const giftsContainer = document.getElementById('giftsContainer');
    giftsContainer.innerHTML = '';
    gifts = [];
    revealedGifts = [];
    
    // Crear 8 regalos en el contenedor
    for (let i = 0; i < 8; i++) {
        const gift = document.createElement('div');
        gift.className = 'gift-box';
        gift.dataset.index = i;
        gift.innerHTML = 'üéÅ';
        
        gift.addEventListener('click', () => selectGift(i));
        giftsContainer.appendChild(gift);
        gifts.push(gift);
    }
    
    // Reiniciar variables del juego
    giftGameScore = 0;
    giftGameLives = 3;
    giftGameTimeLeft = 60;
    giftGameActive = false;
    currentGift = null;
    
    updateGiftGameDisplay();
    showGiftMessage('¬°Haz clic en "Comenzar" para iniciar el juego!', 'info');
}

// Configurar eventos del juego de regalos
function setupGiftGameEvents() {
    const startBtn = document.getElementById('giftStartBtn');
    const hintBtn = document.getElementById('giftHintBtn');
    const skipBtn = document.getElementById('giftSkipBtn');
    
    startBtn.addEventListener('click', startGiftGame);
    hintBtn.addEventListener('click', playGiftHint);
    skipBtn.addEventListener('click', skipCurrentGift);
    
    // Deshabilitar botones hasta que empiece el juego
    hintBtn.disabled = true;
    skipBtn.disabled = true;
}

// Iniciar el juego de regalos
function startGiftGame() {
    if (giftGameActive) return;
    
    giftGameActive = true;
    document.getElementById('giftStartBtn').disabled = true;
    document.getElementById('giftHintBtn').disabled = false;
    document.getElementById('giftSkipBtn').disabled = false;
    
    startGiftTimer();
    selectRandomGift();
    showGiftMessage('¬°Adivina qu√© hay dentro del regalo! Escucha la pista.', 'info');
}

// Seleccionar un regalo aleatorio
function selectRandomGift() {
    const availableGifts = giftTypes.filter((_, index) => !revealedGifts.includes(index));
    
    if (availableGifts.length === 0) {
        endGiftGame(true); // Victoria
        return;
    }
    
    const randomIndex = Math.floor(Math.random() * availableGifts.length);
    currentGift = availableGifts[randomIndex];
    
    updateCurrentGiftDisplay();
    playGiftSound();
}

// Seleccionar un regalo para adivinar
function selectGift(giftIndex) {
    if (!giftGameActive || revealedGifts.includes(giftIndex)) return;
    
    const gift = gifts[giftIndex];
    const giftType = giftTypes[giftIndex];
    
    // Revelar el regalo
    gift.innerHTML = giftType.emoji;
    gift.classList.add('revealed');
    revealedGifts.push(giftIndex);
    
    // Verificar si es el regalo correcto
    if (giftType === currentGift) {
        // ¬°Correcto!
        giftGameScore += giftType.points;
        gift.classList.add('correct');
        showGiftMessage(`¬°Correcto! Era un ${giftType.name}. +${giftType.points} puntos!`, 'success');
        playSuccessSound();
    } else {
        // Incorrecto
        giftGameLives--;
        gift.classList.add('incorrect');
        showGiftMessage(`¬°Oh no! Era un ${giftType.name}. -1 vida.`, 'error');
        playErrorSound();
        
        if (giftGameLives <= 0) {
            endGiftGame(false);
            return;
        }
    }
    
    updateGiftGameDisplay();
    
    // Seleccionar nuevo regalo despu√©s de un breve delay
    setTimeout(() => {
        if (giftGameActive) {
            selectRandomGift();
        }
    }, 1500);
}

// Reproducir pista de sonido
function playGiftHint() {
    if (!giftGameActive || !currentGift) return;
    
    playGiftSound();
    showGiftMessage(`Escuchaste: ${getSoundDescription(currentGift.sound)}`, 'hint');
}

// Reproducir sonido del regalo actual
function playGiftSound() {
    // En un juego real, aqu√≠ ir√≠a la reproducci√≥n de audio
    // Por ahora simulamos con mensajes
    console.log(`Reproduciendo sonido: ${currentGift.sound}`);
}

// Obtener descripci√≥n del sonido
function getSoundDescription(sound) {
    const soundDescriptions = {
        'beep': 'pitidos electr√≥nicos',
        'page': 'p√°ginas pasando',
        'squeak': 'chirrido suave',
        'rustle': 'ruido de tela',
        'unwrap': 'papel desenvuelto',
        'shake': 'sonido de agitaci√≥n',
        'bounce': 'rebote el√°stico',
        'clack': 'clic met√°lico'
    };
    return soundDescriptions[sound] || 'sonido misterioso';
}

// Saltar regalo actual
function skipCurrentGift() {
    if (!giftGameActive) return;
    
    giftGameScore = Math.max(0, giftGameScore - 5); // Penalizaci√≥n por saltar
    showGiftMessage('Saltaste el regalo. -5 puntos.', 'warning');
    updateGiftGameDisplay();
    selectRandomGift();
}

// Actualizar display del juego
function updateGiftGameDisplay() {
    document.getElementById('giftScore').textContent = giftGameScore;
    document.getElementById('giftLives').textContent = giftGameLives;
    document.getElementById('giftTime').textContent = `${giftGameTimeLeft}s`;
    
    // Actualizar vidas visualmente
    const livesElement = document.getElementById('giftLives');
    livesElement.style.color = giftGameLives === 1 ? '#ff4444' : 
                              giftGameLives === 2 ? '#ffaa00' : '#4CAF50';
}

// Actualizar display del regalo actual
function updateCurrentGiftDisplay() {
    const display = document.getElementById('currentGiftDisplay');
    if (currentGift) {
        display.innerHTML = `
            <div class="gift-clue">
                <p><strong>Pista de sonido:</strong></p>
                <p class="sound-description">"${getSoundDescription(currentGift.sound)}"</p>
                <p class="gift-instruction">¬øQu√© regalo hace este sonido?</p>
            </div>
        `;
    }
}

// Mostrar mensaje en el juego
function showGiftMessage(message, type) {
    const messageElement = document.getElementById('giftMessage');
    messageElement.textContent = message;
    messageElement.className = `gift-message ${type}`;
    
    // Auto-ocultar mensajes informativos despu√©s de 3 segundos
    if (type === 'info' || type === 'hint') {
        setTimeout(() => {
            messageElement.className = 'gift-message';
        }, 3000);
    }
}

// Iniciar temporizador del juego
function startGiftTimer() {
    clearInterval(giftGameTimer);
    giftGameTimer = setInterval(() => {
        if (giftGameActive) {
            giftGameTimeLeft--;
            updateGiftGameDisplay();
            
            if (giftGameTimeLeft <= 0) {
                endGiftGame(false);
            }
        }
    }, 1000);
}

// Finalizar el juego
function endGiftGame(isVictory) {
    giftGameActive = false;
    clearInterval(giftGameTimer);
    
    // Actualizar puntuaci√≥n global
    score += giftGameScore;
    updateDisplay();
    
    // Mostrar mensaje final
    if (isVictory) {
        showGiftMessage(`¬°Victoria! Descubriste todos los regalos. Puntuaci√≥n: ${giftGameScore}`, 'success');
        playVictorySound();
    } else {
        showGiftMessage(`¬°Juego terminado! Puntuaci√≥n final: ${giftGameScore}`, 
                       giftGameLives <= 0 ? 'error' : 'info');
    }
    
    // Revelar todos los regalos
    gifts.forEach((gift, index) => {
        if (!revealedGifts.includes(index)) {
            gift.innerHTML = giftTypes[index].emoji;
            gift.classList.add('revealed');
        }
    });
    
    // Habilitar bot√≥n de comenzar
    document.getElementById('giftStartBtn').disabled = false;
    document.getElementById('giftHintBtn').disabled = true;
    document.getElementById('giftSkipBtn').disabled = true;
}

// Sonidos (simulados)
function playSuccessSound() {
    console.log('¬°Sonido de √©xito!');
}

function playErrorSound() {
    console.log('¬°Sonido de error!');
}

function playVictorySound() {
    console.log('¬°Sonido de victoria!');
}

// Detener juego de regalos
function stopGiftGame() {
    giftGameActive = false;
    clearInterval(giftGameTimer);
}

// Agregar estilos CSS para el juego de regalos
function addGiftGameStyles() {
    if (document.getElementById('gift-game-styles')) return;
    
    const style = document.createElement('style');
    style.id = 'gift-game-styles';
    style.textContent = `
        .gift-game-container {
            text-align: center;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .gift-game-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #FFD700;
        }
        
        .gift-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .gift-stat {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 25px;
            border-radius: 25px;
            min-width: 100px;
        }
        
        .current-gift {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .gift-clue {
            font-size: 1.1rem;
        }
        
        .sound-description {
            font-size: 1.3rem;
            font-weight: bold;
            color: #FFD700;
            margin: 10px 0;
        }
        
        .gift-instruction {
            font-style: italic;
            color: #ccc;
        }
        
        .gifts-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
        }
        
        .gift-box {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            background: linear-gradient(135deg, #c8102e, #a00d26);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid #FFD700;
            user-select: none;
            margin: 0 auto;
        }
        
        .gift-box:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }
        
        .gift-box.revealed {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            cursor: default;
        }
        
        .gift-box.revealed:hover {
            transform: none;
            box-shadow: none;
        }
        
        .gift-box.correct {
            animation: correctGuess 0.6s ease;
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }
        
        .gift-box.incorrect {
            animation: incorrectGuess 0.6s ease;
            background: linear-gradient(135deg, #ff4444, #cc0000);
        }
        
        .gift-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .gift-btn {
            background: linear-gradient(135deg, #c8102e, #a00d26);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 140px;
            font-size: 1rem;
        }
        
        .gift-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(200, 16, 46, 0.4);
        }
        
        .gift-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .gift-message {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
            min-height: 20px;
            transition: all 0.3s ease;
        }
        
        .gift-message.success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }
        
        .gift-message.error {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 2px solid #f44336;
        }
        
        .gift-message.warning {
            background: rgba(255, 152, 0, 0.2);
            color: #FF9800;
            border: 2px solid #FF9800;
        }
        
        .gift-message.info {
            background: rgba(33, 150, 243, 0.2);
            color: #2196F3;
            border: 2px solid #2196F3;
        }
        
        .gift-message.hint {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            border: 2px solid #FFD700;
        }
        
        @keyframes correctGuess {
            0% { transform: scale(1); }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(1); }
        }
        
        @keyframes incorrectGuess {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }
        
        @media (max-width: 600px) {
            .gifts-container {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .gift-box {
                width: 70px;
                height: 70px;
                font-size: 2.5rem;
            }
            
            .gift-stats {
                gap: 15px;
            }
            
            .gift-stat {
                min-width: 80px;
                padding: 10px 15px;
            }
            
            .gift-btn {
                min-width: 120px;
                padding: 10px 20px;
            }
        }
    `;
    document.head.appendChild(style);
}
            
// =============================================
// JUEGO "DECORAR EL √ÅRBOL" - √ÅRBOL GIGANTE
// =============================================

// Variables globales para el juego de decorar √°rbol
let treeGameScore = 0;
let treeGameTimer;
let treeGameTimeLeft = 300;
let treeGameActive = false;
let placedDecorations = [];
let selectedDecoration = null;

// Decoraciones navide√±as ampliadas
const decorationTypes = [
    // Bolas cl√°sicas
    { id: 'ball1', emoji: 'üî¥', name: 'Bola Roja', points: 0.5 },
    { id: 'ball2', emoji: 'üîµ', name: 'Bola Azul', points: 0.5 },
    { id: 'ball3', emoji: 'üü¢', name: 'Bola Verde', points: 0.5 },
    { id: 'ball4', emoji: 'üü°', name: 'Bola Amarilla', points: 0.5 },
    { id: 'ball5', emoji: 'üü£', name: 'Bola Morada', points: 0.5 },
    { id: 'ball6', emoji: 'üü†', name: 'Bola Naranja', points: 0.5 },
    
    // Coronaci√≥n
    { id: 'star', emoji: '‚≠ê', name: 'Estrella', points: 1 },
    { id: 'star2', emoji: 'üåü', name: 'Estrella Brillante', points: 1.2 },
    { id: 'angel', emoji: 'üëº', name: '√Ångel', points: 1.5 },
    
    // Luces y brillos
    { id: 'bell', emoji: 'üîî', name: 'Campana', points: 0.8 },
    { id: 'light', emoji: 'üí°', name: 'Bombilla', points: 0.6 },
    { id: 'sparkle', emoji: '‚ú®', name: 'Chispas', points: 0.7 },
    { id: 'diamond', emoji: 'üíé', name: 'Diamante', points: 1.2 },
    
    // Dulces y comida
    { id: 'candy', emoji: 'üç¨', name: 'Caramelo', points: 0.4 },
    { id: 'cookie', emoji: 'üç™', name: 'Galleta', points: 0.6 },
    { id: 'cake', emoji: 'üç∞', name: 'Pastel', points: 1 },
    { id: 'hotchocolate', emoji: '‚òï', name: 'Chocolate Caliente', points: 0.8 },
    
    // Regalos y envoltorios
    { id: 'gift', emoji: 'üéÅ', name: 'Regalo', points: 0.8 },
    { id: 'gift2', emoji: 'üéÄ', name: 'Mo√±o', points: 0.6 },
    
    // Calcetines y tejidos
    { id: 'sock', emoji: 'üß¶', name: 'Calcet√≠n', points: 0.6 },
    
    // Invierno y nieve
    { id: 'snowflake', emoji: '‚ùÑÔ∏è', name: 'Copo de Nieve', points: 0.5 },
    { id: 'snowman', emoji: '‚õÑ', name: 'Mu√±eco de Nieve', points: 1.2 },
    
    // Personajes navide√±os
    { id: 'santa', emoji: 'üéÖ', name: 'Santa Claus', points: 2 },
    { id: 'mrsanta', emoji: 'ü§∂', name: 'Mrs. Claus', points: 1.8 },
    { id: 'elf', emoji: 'üßù', name: 'Elfo', points: 1.5 },
    
    // Animales navide√±os
    { id: 'reindeer', emoji: 'ü¶å', name: 'Reno', points: 1.2 },
    { id: 'penguin', emoji: 'üêß', name: 'Ping√ºino', points: 1 },
    
    // Instrumentos musicales
    { id: 'music', emoji: 'üéµ', name: 'Nota Musical', points: 0.6 },
    { id: 'music2', emoji: 'üé∂', name: 'Notas Musicales', points: 0.8 },
    
    // Emojis divertidos
    { id: 'heart', emoji: '‚ù§Ô∏è', name: 'Coraz√≥n Rojo', points: 2.8 },
    { id: 'heart2', emoji: 'üíö', name: 'Coraz√≥n Verde', points: 0.8 },
    { id: 'rainbow', emoji: 'üåà', name: 'Arco√≠ris', points: 2 },
    { id: 'rocket', emoji: 'üöÄ', name: 'Cohete', points: 1.8 },
    { id: 'unicorn', emoji: 'ü¶Ñ', name: 'Unicornio', points: 2.5 },
    { id: 'alien', emoji: 'üëΩ', name: 'Alien', points: 3 },
    { id: 'robot', emoji: 'ü§ñ', name: 'Robot', points: 2 }
];

// Funci√≥n para cargar el juego "Decorar el √Årbol" - √ÅRBOL GIGANTE
function loadTreeGame() {
    gameArea.innerHTML = `
        <div class="tree-game-container">
            <h3>üéÑ ¬°Decora el √Årbol Gigante!</h3>
            <p>¬°Se creativo! Arrastra cualquier decoraci√≥n al √°rbol gigante. ¬°Diversi√≥n sin l√≠mites!</p>
            
            <div class="tree-game-info">
                <div class="tree-stats">
                    <div class="tree-stat">
                        <span class="stat-label">Puntos Creativos:</span>
                        <span id="treeScore" class="stat-value">0</span>
                    </div>
                    <div class="tree-stat">
                        <span class="stat-label">Tiempo:</span>
                        <span id="treeTime" class="stat-value">300s</span>
                    </div>
                    <div class="tree-stat">
                        <span class="stat-label">Decoraciones:</span>
                        <span id="treeDecorations" class="stat-value">0</span>
                    </div>
                </div>
                
                <div class="tree-rules">
                    <h4>üé® ¬°Reglas Creativas!</h4>
                    <ul>
                        <li>‚ú® ¬°Coloca CUALQUIER decoraci√≥n DONDE QUIERAS!</li>
                        <li>üéØ M√°s puntos por decoraciones especiales</li>
                        <li>üåà ¬°Combina colores y crea dise√±os √∫nicos!</li>
                        <li>‚è∞ 120 segundos de creatividad pura</li>
                    </ul>
                </div>
            </div>
            
            <div class="tree-game-area">
                <div class="decorations-panel" id="decorationsPanel">
                    <h4>üéÅ ¬°Todas las Decoraciones!</h4>
                    <div class="search-decorations">
                        <input type="text" id="decorationSearch" placeholder="üîç Buscar decoraciones..." class="search-input">
                    </div>
                    <div class="decorations-list" id="decorationsList"></div>
                </div>
                
                <div class="tree-area">
                    <div class="tree-container" id="treeContainer">
                        <div class="christmas-tree" id="christmasTree">
                            <!-- El √°rbol GIGANTE se dibujar√° aqu√≠ -->
                        </div>
                        <div class="tree-canvas" id="treeCanvas"></div>
                    </div>
                    
                    <div class="tree-tools">
                        <button id="clearTree" class="tool-btn">üóëÔ∏è Limpiar Todo</button>
                        <button id="randomDecorate" class="tool-btn" disabled>üé≤ Decoraci√≥n Aleatoria</button>
                        <button id="changeBg" class="tool-btn">üåå Cambiar Fondo</button>
                    </div>
                    
                    <div class="selected-decoration" id="selectedDecoration">
                        <p>¬°Selecciona una decoraci√≥n y haz clic en el √°rbol gigante!</p>
                    </div>
                </div>
            </div>
            
            <div class="tree-controls">
                <button id="treeStartBtn" class="tree-btn">üé® Comenzar a Decorar</button>
                <button id="treeResetBtn" class="tree-btn">üîÑ Reiniciar Juego</button>
            </div>
            
            <div class="tree-message" id="treeMessage"></div>
            
            <div class="tree-bonus" id="treeBonus">
                <h4>üéä Logros Creativos:</h4>
                <div class="bonus-list">
                    <div class="bonus-item" data-bonus="colorful">üåà Arco√≠ris M√°gico</div>
                    <div class="bonus-item" data-bonus="special">üöÄ Decoraci√≥n Especial</div>
                    <div class="bonus-item" data-bonus="crowded">üé™ √Årbol Llen√≠simo</div>
                    <div class="bonus-item" data-bonus="master">üé® Maestro Decorador</div>
                </div>
            </div>
        </div>
    `;
    
    initializeTreeGame();
    setupTreeGameEvents();
    addTreeGameStyles();
}

// Inicializar el juego del √°rbol - √ÅRBOL GIGANTE
function initializeTreeGame() {
    const decorationsList = document.getElementById('decorationsList');
    const treeCanvas = document.getElementById('treeCanvas');
    
    // Limpiar contenedores
    decorationsList.innerHTML = '';
    treeCanvas.innerHTML = '';
    placedDecorations = [];
    
    // Crear todas las decoraciones disponibles
    renderDecorationsList();
    
    // Dibujar el √°rbol GIGANTE
    drawChristmasTree();
    
    // Reiniciar variables del juego
    treeGameScore = 0;
    treeGameTimeLeft = 300;
    treeGameActive = false;
    selectedDecoration = null;
    
    updateTreeGameDisplay();
    showTreeMessage('üé® ¬°Selecciona cualquier decoraci√≥n y haz clic en el √°rbol gigante donde quieras ponerla!', 'info');
}

// Renderizar lista de decoraciones con b√∫squeda
function renderDecorationsList(filter = '') {
    const decorationsList = document.getElementById('decorationsList');
    decorationsList.innerHTML = '';
    
    const filteredDecorations = decorationTypes.filter(decoration => 
        decoration.name.toLowerCase().includes(filter.toLowerCase()) ||
        decoration.emoji.includes(filter)
    );
    
    filteredDecorations.forEach((decoration, index) => {
        const decoElement = document.createElement('div');
        decoElement.className = 'decoration-item';
        decoElement.dataset.id = decoration.id;
        decoElement.innerHTML = `
            <span class="decoration-emoji">${decoration.emoji}</span>
            <span class="decoration-name">${decoration.name}</span>
            <span class="decoration-points">+${decoration.points}</span>
        `;
        
        decoElement.addEventListener('click', () => selectDecoration(decoration));
        decorationsList.appendChild(decoElement);
    });
}

// Dibujar el √°rbol de Navidad GIGANTE
function drawChristmasTree() {
    const treeContainer = document.getElementById('christmasTree');
    
    treeContainer.innerHTML = `
        <div class="tree-layer layer-1"></div>
        <div class="tree-layer layer-2"></div>
        <div class="tree-layer layer-3"></div>
        <div class="tree-layer layer-4"></div>
        <div class="tree-layer layer-5"></div>
        <div class="tree-trunk"></div>
        <div class="tree-glow"></div>
        <div class="tree-lights"></div>
    `;
}

// Seleccionar una decoraci√≥n
function selectDecoration(decoration) {
    selectedDecoration = decoration;
    
    // Resaltar la decoraci√≥n seleccionada
    document.querySelectorAll('.decoration-item').forEach(item => {
        item.classList.remove('selected');
    });
    document.querySelector(`[data-id="${decoration.id}"]`).classList.add('selected');
    
    updateSelectedDecorationDisplay();
    showTreeMessage(`Seleccionado: ${decoration.emoji} ${decoration.name}. ¬°Haz clic en el √°rbol!`, 'info');
}

// Actualizar display de decoraci√≥n seleccionada
function updateSelectedDecorationDisplay() {
    const display = document.getElementById('selectedDecoration');
    if (selectedDecoration) {
        display.innerHTML = `
            <div class="selected-deco-info">
                <span class="selected-emoji">${selectedDecoration.emoji}</span>
                <div class="selected-details">
                    <strong>${selectedDecoration.name}</strong>
                    <span>+${selectedDecoration.points} puntos creativos</span>
                </div>
            </div>
            <p>¬°Haz clic en cualquier parte del √°rbol gigante para colocar esta decoraci√≥n!</p>
        `;
    }
}

// Colocar decoraci√≥n en el √°rbol - ¬°EN CUALQUIER PARTE!
function placeDecorationOnTree(event) {
    if (!selectedDecoration || !treeGameActive) return;
    
    const treeCanvas = document.getElementById('treeCanvas');
    const rect = treeCanvas.getBoundingClientRect();
    
    // Calcular posici√≥n relativa al √°rbol
    const x = ((event.clientX - rect.left) / rect.width) * 100;
    const y = ((event.clientY - rect.top) / rect.height) * 100;
    
    // Verificar que el clic fue dentro del √°rbol
    if (x < 0 || x > 100 || y < 0 || y > 100) return;
    
    // Crear elemento de decoraci√≥n
    const decorationElement = document.createElement('div');
    decorationElement.className = 'tree-decoration';
    decorationElement.innerHTML = selectedDecoration.emoji;
    decorationElement.style.left = `${x}%`;
    decorationElement.style.top = `${y}%`;
    
    // Efectos especiales para decoraciones con muchos puntos
    if (selectedDecoration.points >= 2) {
        decorationElement.classList.add('special-decoration');
        decorationElement.style.animation = 'specialGlow 2s infinite';
    }
    
    // Tama√±o aleatorio para hacerlo m√°s natural
    const randomSize = 0.8 + Math.random() * 0.4;
    decorationElement.style.fontSize = `${randomSize * 2.5}rem`;
    
    // Agregar al √°rbol
    treeCanvas.appendChild(decorationElement);
    
    // Guardar informaci√≥n de la decoraci√≥n colocada
    const placedDeco = {
        id: selectedDecoration.id,
        emoji: selectedDecoration.emoji,
        name: selectedDecoration.name,
        points: selectedDecoration.points,
        element: decorationElement,
        x: x,
        y: y
    };
    
    placedDecorations.push(placedDeco);
    
    // Sumar puntos
    treeGameScore += selectedDecoration.points;
    
    // Efecto visual de colocaci√≥n
    decorationElement.style.animation = 'placeDecoration 0.6s ease';
    
    // Verificar logros creativos
    checkCreativeAchievements();
    
    updateTreeGameDisplay();
    
    // Mensaje especial para decoraciones √∫nicas
    if (selectedDecoration.points >= 2) {
        showTreeMessage(`üéâ ¬°WOW! ${selectedDecoration.emoji} ${selectedDecoration.name} - ¬°Decoraci√≥n √âpica! +${selectedDecoration.points}pts`, 'bonus');
    } else {
        showTreeMessage(`‚úÖ ${selectedDecoration.emoji} colocado! +${selectedDecoration.points} puntos creativos`, 'success');
    }
    
    // Reproducir sonido
    playDecorationSound();
}

// Verificar logros creativos
function checkCreativeAchievements() {
    const decorationCount = placedDecorations.length;
    const specialDecorations = placedDecorations.filter(deco => deco.points >= 2).length;
    const emojisUsed = [...new Set(placedDecorations.map(deco => deco.emoji))];
    const randomBtn = document.getElementById('randomDecorate');
    
    let bonusMessage = '';
    
    // Logro: Arco√≠ris M√°gico (muchos colores diferentes)
    if (emojisUsed.length >= 10 && !document.querySelector('[data-bonus="colorful"]').classList.contains('achieved')) {
        treeGameScore += 10;
        bonusMessage += 'üåà Arco√≠ris M√°gico +10pts\n';
        document.querySelector('[data-bonus="colorful"]').classList.add('achieved');
    }
    
    // Logro: Decoraci√≥n Especial (muchas decoraciones especiales)
    if (specialDecorations >= 5 && !document.querySelector('[data-bonus="special"]').classList.contains('achieved')) {
        treeGameScore += 30;
        bonusMessage += 'üöÄ Decoraci√≥n Especial +30pts\n';
        document.querySelector('[data-bonus="special"]').classList.add('achieved');
    }
    
    // Logro: √Årbol Llen√≠simo (muchas decoraciones)
    if (decorationCount >= 20 && !document.querySelector('[data-bonus="crowded"]').classList.contains('achieved')) {
        treeGameScore += 20;
        bonusMessage += 'üé™ √Årbol Llen√≠simo +20pts\n';
        document.querySelector('[data-bonus="crowded"]').classList.add('achieved');
    }
    
    // Logro: Maestro Decorador (puntuaci√≥n muy alta)
    if (treeGameScore >= 200 && !document.querySelector('[data-bonus="master"]').classList.contains('achieved')) {
        treeGameScore += 150;
        bonusMessage += 'üé® Maestro Decorador +150pts\n';
        document.querySelector('[data-bonus="master"]').classList.add('achieved');
        randomBtn.disabled = false;
    }
    
    // Aplicar bonos
    if (bonusMessage) {
        showTreeMessage(`üéä ¬°Logro Creativo!\n${bonusMessage}`, 'bonus');
        playBonusSound();
    }
    
    updateTreeGameDisplay();
}

// Configurar eventos del juego del √°rbol
function setupTreeGameEvents() {
    const startBtn = document.getElementById('treeStartBtn');
    const resetBtn = document.getElementById('treeResetBtn');
    const clearBtn = document.getElementById('clearTree');
    const randomBtn = document.getElementById('randomDecorate');
    const changeBgBtn = document.getElementById('changeBg');
    const searchInput = document.getElementById('decorationSearch');
    const treeCanvas = document.getElementById('treeCanvas');
    
    startBtn.addEventListener('click', startTreeGame);
    resetBtn.addEventListener('click', initializeTreeGame);
    clearBtn.addEventListener('click', clearTree);
    randomBtn.addEventListener('click', randomDecoration);
    changeBgBtn.addEventListener('click', changeBackground);
    searchInput.addEventListener('input', (e) => renderDecorationsList(e.target.value));
    
    // Evento para colocar decoraciones en CUALQUIER parte del √°rbol
    treeCanvas.addEventListener('click', placeDecorationOnTree);
}

// Iniciar el juego del √°rbol
function startTreeGame() {
    if (treeGameActive) return;
    
    treeGameActive = true;
    document.getElementById('treeStartBtn').disabled = true;
    
    startTreeTimer();
    showTreeMessage('üé® ¬°Tiempo de creatividad! Decora el √°rbol gigante como quieras - 120 segundos', 'success');
}

// Limpiar todo el √°rbol
function clearTree() {
    const treeCanvas = document.getElementById('treeCanvas');
    treeCanvas.innerHTML = '';
    placedDecorations = [];
    treeGameScore = 0;
    
    // Resetear logros
    document.querySelectorAll('.bonus-item').forEach(item => {
        item.classList.remove('achieved');
    });
    
    updateTreeGameDisplay();
    showTreeMessage('üóëÔ∏è ¬°√Årbol limpiado! Comienza de nuevo', 'info');
}

// Decoraci√≥n aleatoria
function randomDecoration() {
    if (!treeGameActive) return;
    
    const randomDeco = decorationTypes[Math.floor(Math.random() * decorationTypes.length)];
    selectedDecoration = randomDeco;
    
    // Colocar en posici√≥n aleatoria
    const treeCanvas = document.getElementById('treeCanvas');
    const fakeEvent = {
        clientX: treeCanvas.getBoundingClientRect().left + Math.random() * treeCanvas.offsetWidth,
        clientY: treeCanvas.getBoundingClientRect().top + Math.random() * treeCanvas.offsetHeight
    };
    
    placeDecorationOnTree(fakeEvent);
    showTreeMessage(`üé≤ Decoraci√≥n aleatoria: ${randomDeco.emoji}`, 'info');
}

// Cambiar fondo
function changeBackground() {
    const backgrounds = [
        'linear-gradient(135deg, #1e3c72, #2a5298)',
        'linear-gradient(135deg, #667eea, #764ba2)',
        'linear-gradient(135deg, #f093fb, #f5576c)',
        'linear-gradient(135deg, #4facfe, #00f2fe)',
        'linear-gradient(135deg, #43e97b, #38f9d7)',
        'linear-gradient(135deg, #fa709a, #fee140)',
        'linear-gradient(135deg, #a8edea, #fed6e3)',
        'linear-gradient(135deg, #d4fc79, #96e6a1)',
        'linear-gradient(135deg, #4e9955ff, #1587c9ff)',
        'linear-gradient(135deg, #54b364ff, #761294ff)',
        'linear-gradient(135deg, #c4cf21ff, #772bceff)'
        
    ];
    
    const treeContainer = document.getElementById('treeContainer');
    const randomBg = backgrounds[Math.floor(Math.random() * backgrounds.length)];
    treeContainer.style.background = randomBg;
    
    showTreeMessage('üåå ¬°Fondo cambiado!', 'info');
}

// Actualizar display del juego
function updateTreeGameDisplay() {
    document.getElementById('treeScore').textContent = treeGameScore;
    document.getElementById('treeTime').textContent = `${treeGameTimeLeft}s`;
    document.getElementById('treeDecorations').textContent = placedDecorations.length;
    
    // Efecto visual cuando hay muchas decoraciones
    const decorationsElement = document.getElementById('treeDecorations');
    if (placedDecorations.length >= 15) {
        decorationsElement.style.color = '#FFD700';
        decorationsElement.style.fontWeight = 'bold';
    }
}

// Mostrar mensaje en el juego
function showTreeMessage(message, type) {
    const messageElement = document.getElementById('treeMessage');
    messageElement.textContent = message;
    messageElement.className = `tree-message ${type}`;
    
    setTimeout(() => {
        if (messageElement.textContent === message) {
            messageElement.className = 'tree-message';
        }
    }, 4000);
}

// Iniciar temporizador del √°rbol
function startTreeTimer() {
    clearInterval(treeGameTimer);
    treeGameTimer = setInterval(() => {
        if (treeGameActive) {
            treeGameTimeLeft--;
            updateTreeGameDisplay();
            
            if (treeGameTimeLeft <= 0) {
                endTreeGame();
            }
        }
    }, 1000);
}

// Finalizar el juego del √°rbol
function endTreeGame() {
    treeGameActive = false;
    clearInterval(treeGameTimer);
    
    // Actualizar puntuaci√≥n global
    score += treeGameScore;
    updateDisplay();
    
    const finalScore = treeGameScore;
    const decoCount = placedDecorations.length;
    
    let message = `‚è∞ ¬°Tiempo agotado!\nPuntuaci√≥n Creativa: ${finalScore} puntos\nDecoraciones: ${decoCount}`;
    
    if (finalScore >= 300) {
        message += '\nüéâ ¬°Eres un Maestro Decorador!';
    } else if (finalScore >= 150) {
        message += '\nüåü ¬°Excelente trabajo creativo!';
    }
    
    showTreeMessage(message, 'success');
    document.getElementById('treeStartBtn').disabled = false;
}

// Sonidos del juego
function playDecorationSound() {
    // Simular sonido de decoraci√≥n colocada
    console.log('¬°Sonido creativo!');
}

function playBonusSound() {
    // Simular sonido de logro
    console.log('¬°Sonido de logro!');
}

// Detener juego del √°rbol
function stopTreeGame() {
    treeGameActive = false;
    clearInterval(treeGameTimer);
}

// Agregar estilos CSS para el √°rbol GIGANTE
function addTreeGameStyles() {
    if (document.getElementById('tree-game-styles')) return;
    
    const style = document.createElement('style');
    style.id = 'tree-game-styles';
    style.textContent = `
        .tree-game-container {
            text-align: center;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .tree-game-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .tree-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .tree-stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
            border-radius: 15px;
            min-width: 120px;
        }
        
        .tree-rules {
            background: rgba(255, 215, 0, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FFD700;
            text-align: left;
        }
        
        .tree-rules ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .tree-rules li {
            margin: 5px 0;
            font-size: 0.9rem;
        }
        
        .tree-game-area {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            margin: 25px 0;
        }
        
        .decorations-panel {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid #c8102e;
            max-height: 700px;
            overflow-y: auto;
        }
        
        .search-decorations {
            margin-bottom: 15px;
        }
        
        .search-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #FFD700;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }
        
        .search-input::placeholder {
            color: #ccc;
        }
        
        .decorations-list {
            display: grid;
            grid-template-columns: 1fr;
            gap: 8px;
            margin-top: 10px;
        }
        
        .decoration-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .decoration-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }
        
        .decoration-item.selected {
            background: rgba(255, 215, 0, 0.3);
            border-color: #FFD700;
            transform: scale(1.05);
        }
        
        .decoration-emoji {
            font-size: 1.4rem;
            min-width: 30px;
        }
        
        .decoration-name {
            flex: 1;
            text-align: left;
            font-size: 0.85rem;
        }
        
        .decoration-points {
            background: #9C27B0;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: bold;
        }
        
        .tree-area {
            position: relative;
        }
        
        /* √ÅRBOL GIGANTE - Contenedor principal */
        .tree-container {
            position: relative;
            width: 100%;
            height: 700px; /* ¬°MUCHO M√ÅS GRANDE! */
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            border-radius: 25px;
            overflow: hidden;
            border: 4px solid #FFD700;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }
        
        .christmas-tree {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .tree-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: crosshair;
        }
        
        /* Capas del √°rbol GIGANTE */
        .tree-layer {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 150px solid transparent;
            border-right: 150px solid transparent;
        }
        
        .tree-layer.layer-1 {
            top: 8%;
            border-bottom: 180px solid #1B5E20;
        }
        
        .tree-layer.layer-2 {
            top: 22%;
            border-bottom: 160px solid #2E7D32;
        }
        
        .tree-layer.layer-3 {
            top: 36%;
            border-bottom: 140px solid #388E3C;
        }
        
        .tree-layer.layer-4 {
            top: 50%;
            border-bottom: 120px solid #43A047;
        }

        .tree-layer.layer-5 {
            top: 65%;
            border-bottom: 120px solid #48b44eff;
        }
        
        .tree-trunk {
            position: absolute;
            bottom: 5%;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 100px;
            background: #5D4037;
            border-radius: 10px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
        }
        
        .tree-glow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, transparent 20%, rgba(255,215,0,0.15) 80%);
            pointer-events: none;
        }
        
        .tree-lights {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 15%, rgba(255,0,0,0.3) 2%, transparent 3%),
                radial-gradient(circle at 80% 25%, rgba(0,255,0,0.3) 2%, transparent 3%),
                radial-gradient(circle at 40% 40%, rgba(0,0,255,0.3) 2%, transparent 3%),
                radial-gradient(circle at 60% 60%, rgba(255,255,0,0.3) 2%, transparent 3%),
                radial-gradient(circle at 30% 75%, rgba(255,0,255,0.3) 2%, transparent 3%);
            pointer-events: none;
            animation: twinkle 3s infinite alternate;
        }
        
        .tree-decoration {
            position: absolute;
            font-size: 0.5rem;
            user-select: none;
            transform: translate(-50%, -50%);
            filter: drop-shadow(3px 3px 8px rgba(0,0,0,0.8));
            cursor: pointer;
            transition: transform 0.2s ease;
            z-index: 10;
        }
        
        .tree-decoration:hover {
            transform: translate(-50%, -50%) scale(1.3);
            z-index: 100;
        }
        
        .special-decoration {
            font-size: 2rem;
            filter: drop-shadow(0 0 15px rgba(255,215,0,0.9));
        }
        
        .tree-tools {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        
        .tool-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid #FFD700;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .tool-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-3px);
        }
        
        .selected-decoration {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border: 2px solid #FFD700;
        }
        
        .selected-deco-info {
            display: flex;
            align-items: center;
            gap: 20px;
            justify-content: center;
        }
        
        .selected-emoji {
            font-size: 3rem;
        }
        
        .tree-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .tree-btn {
            background: linear-gradient(135deg, #c8102e, #a00d26);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 200px;
            font-size: 1.1rem;
        }
        
        .tree-btn:hover:not(:disabled) {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(200, 16, 46, 0.5);
        }
        
        .tree-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .tree-message {
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            font-weight: bold;
            white-space: pre-line;
            min-height: 25px;
            font-size: 1.2rem;
        }
        
        .tree-message.success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }
        
        .tree-message.info {
            background: rgba(33, 150, 243, 0.2);
            color: #2196F3;
            border: 2px solid #2196F3;
        }
        
        .tree-message.bonus {
            background: rgba(156, 39, 176, 0.3);
            color: #E1BEE7;
            border: 2px solid #9C27B0;
            animation: pulse 1s infinite;
        }
        
        .tree-bonus {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 20px;
            margin-top: 25px;
        }
        
        .bonus-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .bonus-item {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }
        
        .bonus-item.achieved {
            background: rgba(76, 175, 80, 0.3);
            border-color: #4CAF50;
            color: #C8E6C9;
            animation: glow 2s infinite;
        }
        
        @keyframes placeDecoration {
            0% { 
                transform: translate(-50%, -50%) scale(0) rotate(-180deg); 
                opacity: 0;
            }
            70% { 
                transform: translate(-50%, -50%) scale(1.4) rotate(15deg); 
            }
            100% { 
                transform: translate(-50%, -50%) scale(1) rotate(0deg); 
                opacity: 1;
            }
        }
        
        @keyframes specialGlow {
            0%, 100% { 
                filter: drop-shadow(0 0 15px rgba(255,215,0,0.9)) 
                        drop-shadow(0 0 25px rgba(255,0,0,0.7));
            }
            50% { 
                filter: drop-shadow(0 0 20px rgba(0,255,255,0.9)) 
                        drop-shadow(0 0 35px rgba(0,0,255,0.7));
            }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px #4CAF50; }
            50% { box-shadow: 0 0 25px #4CAF50; }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 0.7; }
        }
        
        @media (max-width: 1024px) {
            .tree-container {
                height: 600px;
            }
            
            .tree-layer {
                border-left: 120px solid transparent;
                border-right: 120px solid transparent;
            }
        }
        
        @media (max-width: 768px) {
            .tree-game-area {
                grid-template-columns: 1fr;
            }
            
            .tree-game-info {
                grid-template-columns: 1fr;
            }
            
            .tree-stats {
                flex-wrap: wrap;
            }
            
            .tree-container {
                height: 500px;
            }
            
            .tree-layer {
                border-left: 80px solid transparent;
                border-right: 80px solid transparent;
            }
            
            .decorations-panel {
                max-height: 400px;
            }
        }
    `;
    document.head.appendChild(style);
}
            
            function loadSleighGame() {
                gameArea.innerHTML = `<h3>Carrera de Trineos</h3><p>Usa las flechas para esquivar obst√°culos y recolectar regalos</p>`;
            }
            
// =============================================
// JUEGO "SIM√ìN DICE NAVIDE√ëO"
// =============================================

// Variables globales para el juego Sim√≥n Dice
let simonSequence = [];
let playerSequence = [];
let simonLevel = 1;
let simonScore = 0;
let simonLives = 3;
let simonGameActive = false;
let simonCanPlay = false;
let simonTimer;
let simonSpeed = 1000;

// Colores/emojis navide√±os para Sim√≥n
const simonColors = [
    { 
        id: 'red', 
        emoji: 'üéÖ', 
        name: 'Noel', 
        color: '#ff4444', 
        lightColor: '#ff6666',
        sound: 'C'
    },
    { 
        id: 'green', 
        emoji: 'üéÑ', 
        name: 'Arbol', 
        color: '#4CAF50', 
        lightColor: '#66bb6a',
        sound: 'E'
    },
    { 
        id: 'yellow', 
        emoji: 'üåü', 
        name: 'Estrella', 
        color: '#FFD700', 
        lightColor: '#ffeb3b',
        sound: 'G'
    },
    { 
        id: 'blue', 
        emoji: '‚ùÑ', 
        name: 'Copo', 
        color: '#2196F3', 
        lightColor: '#42a5f5',
        sound: 'A'
    }
];

// Funci√≥n para cargar el juego Sim√≥n Dice
function loadSimonGame() {
    gameArea.innerHTML = `
        <div class="simon-game-container">
            <h3>üéÆ Sim√≥n Dice Navide√±o</h3>
            <p>¬°Memoriza la secuencia de colores navide√±os y rep√≠tela! Cada nivel es m√°s dif√≠cil.</p>
            
            <div class="simon-game-info">
                <div class="simon-stats">
                    <div class="simon-stat">
                        <span class="stat-label">Nivel:</span>
                        <span id="simonLevel" class="stat-value">1</span>
                    </div>
                    <div class="simon-stat">
                        <span class="stat-label">Puntos:</span>
                        <span id="simonScore" class="stat-value">0</span>
                    </div>
                    <div class="simon-stat">
                        <span class="stat-label">Vidas:</span>
                        <span id="simonLives" class="stat-value">3</span>
                    </div>
                    <div class="simon-stat">
                        <span class="stat-label">Secuencia:</span>
                        <span id="simonSequenceLength" class="stat-value">0</span>
                    </div>
                </div>
                
                <div class="simon-instructions">
                    <h4>üéØ C√≥mo Jugar:</h4>
                    <ul>
                        <li>üëÅÔ∏è Observa la secuencia que muestra Sim√≥n</li>
                        <li>üéπ Repite la secuencia en el mismo orden</li>
                        <li>‚ö° ¬°Cada nivel es m√°s r√°pido!</li>
                        <li>üí´ ¬°Gana puntos por velocidad y precisi√≥n!</li>
                    </ul>
                </div>
            </div>
            
            <div class="simon-game-area">
                <div class="simon-board" id="simonBoard">
                    <!-- Los botones de Sim√≥n se generar√°n aqu√≠ -->
                </div>
                
                <div class="simon-display">
                    <div class="simon-message" id="simonMessage">
                        ¬°Presiona "Comenzar" para jugar!
                    </div>
                    <div class="simon-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="simonProgress"></div>
                        </div>
                        <div class="progress-text" id="simonProgressText">Esperando...</div>
                    </div>
                </div>
            </div>
            
            <div class="simon-controls">
                <button id="simonStartBtn" class="simon-btn">üéØ Comenzar Juego</button>
                <button id="simonRestartBtn" class="simon-btn">üîÑ Reiniciar</button>
                <button id="simonHintBtn" class="simon-btn">üí° Mostrar Secuencia</button>
                <button id="simonSpeedBtn" class="simon-btn">‚ö° Cambiar Velocidad</button>
            </div>
            
            <div class="simon-achievements">
                <h4>üèÜ Logros:</h4>
                <div class="achievement-list">
                    <div class="achievement-item" data-achievement="beginner">üéÑ Nivel 5</div>
                    <div class="achievement-item" data-achievement="advanced">üåü Nivel 10</div>
                    <div class="achievement-item" data-achievement="expert">üéÖ Nivel 15</div>
                    <div class="achievement-item" data-achievement="master">üî• Nivel 20</div>
                </div>
            </div>
        </div>
    `;
    
    initializeSimonGame();
    setupSimonEvents();
    addSimonStyles();
}

// Inicializar el juego Sim√≥n
function initializeSimonGame() {
    const simonBoard = document.getElementById('simonBoard');
    simonBoard.innerHTML = '';
    
    // Crear los 4 botones de Sim√≥n
    simonColors.forEach((color, index) => {
        const button = document.createElement('div');
        button.className = `simon-button ${color.id}`;
        button.dataset.color = color.id;
        button.innerHTML = `
            <span class="simon-emoji">${color.emoji}</span>
            <div class="simon-glow"></div>
        `;
        
        // Estilos para el bot√≥n
        button.style.backgroundColor = color.color;
        button.style.borderColor = color.lightColor;
        
        button.addEventListener('click', () => handleSimonClick(color.id));
        simonBoard.appendChild(button);
    });
    
    // Reiniciar variables del juego
    simonSequence = [];
    playerSequence = [];
    simonLevel = 1;
    simonScore = 0;
    simonLives = 3;
    simonGameActive = false;
    simonCanPlay = false;
    simonSpeed = 1000;
    
    updateSimonDisplay();
    showSimonMessage('üéÆ ¬°Presiona "Comenzar" para iniciar el juego!', 'info');
}

// Configurar eventos del juego Sim√≥n
function setupSimonEvents() {
    const startBtn = document.getElementById('simonStartBtn');
    const restartBtn = document.getElementById('simonRestartBtn');
    const hintBtn = document.getElementById('simonHintBtn');
    const speedBtn = document.getElementById('simonSpeedBtn');
    
    startBtn.addEventListener('click', startSimonGame);
    restartBtn.addEventListener('click', initializeSimonGame);
    hintBtn.addEventListener('click', showSimonHint);
    speedBtn.addEventListener('click', changeSimonSpeed);
    
    // Deshabilitar botones hasta que empiece el juego
    hintBtn.disabled = true;
    speedBtn.disabled = true;
}

// Iniciar el juego Sim√≥n
function startSimonGame() {
    if (simonGameActive) return;
    
    simonGameActive = true;
    document.getElementById('simonStartBtn').disabled = true;
    document.getElementById('simonHintBtn').disabled = false;
    document.getElementById('simonSpeedBtn').disabled = false;
    
    // Comenzar nuevo nivel
    startSimonLevel();
}

// Comenzar nuevo nivel
function startSimonLevel() {
    playerSequence = [];
    simonCanPlay = false;
    
    // Agregar nuevo color a la secuencia
    const randomColor = simonColors[Math.floor(Math.random() * simonColors.length)].id;
    simonSequence.push(randomColor);
    
    updateSimonDisplay();
    showSimonMessage(`Nivel ${simonLevel} - Observa la secuencia...`, 'info');
    
    // Mostrar la secuencia completa
    showSimonSequence();
}

// Mostrar la secuencia de Sim√≥n
function showSimonSequence() {
    let delay = 500;
    
    // Deshabilitar clicks durante la secuencia
    simonCanPlay = false;
    
    // Mostrar cada color de la secuencia
    simonSequence.forEach((color, index) => {
        setTimeout(() => {
            highlightSimonButton(color);
            playSimonSound(color);
            
            // Barra de progreso
            updateProgressBar((index + 1) / simonSequence.length * 100, `Mostrando: ${index + 1}/${simonSequence.length}`);
            
        }, delay);
        delay += simonSpeed;
    });
    
    // Permitir al jugador repetir la secuencia
    setTimeout(() => {
        simonCanPlay = true;
        playerSequence = [];
        showSimonMessage('¬°Tu turno! Repite la secuencia...', 'success');
        updateProgressBar(0, '¬°Tu turno! Haz clic en los botones...');
        
        // Iniciar temporizador para el jugador
        startPlayerTimer();
        
    }, delay + 500);
}

// Resaltar bot√≥n de Sim√≥n
function highlightSimonButton(colorId) {
    const button = document.querySelector(`.simon-button.${colorId}`);
    const colorData = simonColors.find(c => c.id === colorId);
    
    if (button && colorData) {
        // Efecto visual de resaltado
        button.style.backgroundColor = colorData.lightColor;
        button.style.transform = 'scale(1.1)';
        button.style.boxShadow = `0 0 30px ${colorData.lightColor}`;
        
        // Restaurar despu√©s de un tiempo
        setTimeout(() => {
            button.style.backgroundColor = colorData.color;
            button.style.transform = 'scale(1)';
            button.style.boxShadow = '0 0 10px rgba(0,0,0,0.3)';
        }, simonSpeed / 2);
    }
}

// Manejar clic del jugador
function handleSimonClick(colorId) {
    if (!simonCanPlay || !simonGameActive) return;
    
    // Agregar a la secuencia del jugador
    playerSequence.push(colorId);
    
    // Resaltar el bot√≥n clickeado
    highlightSimonButton(colorId);
    playSimonSound(colorId);
    
    // Verificar si es correcto
    checkSimonSequence();
    
    // Actualizar barra de progreso
    const progress = (playerSequence.length / simonSequence.length) * 100;
    updateProgressBar(progress, `Progreso: ${playerSequence.length}/${simonSequence.length}`);
}

// Verificar la secuencia del jugador
function checkSimonSequence() {
    const currentIndex = playerSequence.length - 1;
    
    // Verificar si el √∫ltimo movimiento es correcto
    if (playerSequence[currentIndex] !== simonSequence[currentIndex]) {
        // Error en la secuencia
        handleSimonError();
        return;
    }
    
    // Verificar si complet√≥ la secuencia correctamente
    if (playerSequence.length === simonSequence.length) {
        handleSimonSuccess();
    }
}

// Manejar √©xito en la secuencia
function handleSimonSuccess() {
    // Calcular puntos (m√°s puntos por niveles altos y velocidad)
    const levelBonus = simonLevel * 10;
    const speedBonus = Math.max(0, 50 - (simonSpeed / 20));
    const points = levelBonus + speedBonus;
    
    simonScore += Math.round(points);
    simonLevel++;
    
    // Aumentar dificultad cada 3 niveles
    if (simonLevel % 3 === 0 && simonSpeed > 300) {
        simonSpeed -= 100;
    }
    
    showSimonMessage(`üéâ ¬°Correcto! +${Math.round(points)} puntos. Nivel ${simonLevel}...`, 'success');
    playSuccessSound();
    
    // Verificar logros
    checkSimonAchievements();
    
    // Siguiente nivel despu√©s de un breve descanso
    setTimeout(() => {
        if (simonGameActive) {
            startSimonLevel();
        }
    }, 1500);
}

// Manejar error en la secuencia
function handleSimonError() {
    simonLives--;
    
    // Efecto visual de error
    document.querySelectorAll('.simon-button').forEach(button => {
        button.style.animation = 'shake 0.5s ease';
    });
    
    showSimonMessage('‚ùå ¬°Secuencia incorrecta! -1 vida', 'error');
    playErrorSound();
    
    // Actualizar display
    updateSimonDisplay();
    
    if (simonLives <= 0) {
        endSimonGame(false);
    } else {
        // Reintentar el mismo nivel
        setTimeout(() => {
            playerSequence = [];
            showSimonMessage('Reintentando nivel...', 'info');
            showSimonSequence();
        }, 2000);
    }
}

// Mostrar pista de la secuencia
function showSimonHint() {
    if (!simonGameActive || simonCanPlay) return;
    
    showSimonMessage(`üí° Pista: La secuencia tiene ${simonSequence.length} movimientos`, 'hint');
    
    // Peque√±a penalizaci√≥n por usar pista
    simonScore = Math.max(0, simonScore - 5);
    updateSimonDisplay();
}

// Cambiar velocidad del juego
function changeSimonSpeed() {
    if (!simonGameActive) return;
    
    const speeds = [1500, 1000, 800, 600, 400];
    const currentIndex = speeds.indexOf(simonSpeed);
    const nextIndex = (currentIndex + 1) % speeds.length;
    
    simonSpeed = speeds[nextIndex];
    
    const speedNames = ['Muy Lento', 'Lento', 'Normal', 'R√°pido', 'Muy R√°pido'];
    showSimonMessage(`‚ö° Velocidad: ${speedNames[nextIndex]}`, 'info');
}

// Iniciar temporizador del jugador
function startPlayerTimer() {
    clearTimeout(simonTimer);
    
    // El jugador tiene 10 segundos para completar la secuencia
    simonTimer = setTimeout(() => {
        if (simonCanPlay && playerSequence.length < simonSequence.length) {
            handleSimonError();
        }
    }, 10000);
}

// Verificar logros de Sim√≥n
function checkSimonAchievements() {
    const achievements = {
        'beginner': 5,
        'advanced': 10,
        'expert': 15,
        'master': 20
    };
    
    Object.entries(achievements).forEach(([achievement, level]) => {
        if (simonLevel >= level && !document.querySelector(`[data-achievement="${achievement}"]`).classList.contains('achieved')) {
            document.querySelector(`[data-achievement="${achievement}"]`).classList.add('achieved');
            
            // Bonus por logro
            const bonus = level * 20;
            simonScore += bonus;
            
            showSimonMessage(`üèÜ ¬°Logro desbloqueado! Nivel ${level} +${bonus} puntos`, 'bonus');
            playBonusSound();
        }
    });
}

// Reproducir sonido de Sim√≥n
function playSimonSound(colorId) {
    const colorData = simonColors.find(c => c.id === colorId);
    if (!colorData) return;
    
    // En un juego real, aqu√≠ reproducir√≠as el sonido correspondiente
    console.log(`Reproduciendo sonido: ${colorData.sound} para ${colorData.name}`);
}

// Reproducir sonido de √©xito
function playSuccessSound() {
    console.log('¬°Sonido de √©xito!');
}

// Reproducir sonido de error
function playErrorSound() {
    console.log('¬°Sonido de error!');
}

// Reproducir sonido de bonus
function playBonusSound() {
    console.log('¬°Sonido de bonus!');
}

// Actualizar display de Sim√≥n
function updateSimonDisplay() {
    document.getElementById('simonLevel').textContent = simonLevel;
    document.getElementById('simonScore').textContent = Math.round(simonScore);
    document.getElementById('simonLives').textContent = simonLives;
    document.getElementById('simonSequenceLength').textContent = simonSequence.length;
    
    // Actualizar color de vidas
    const livesElement = document.getElementById('simonLives');
    if (simonLives === 1) {
        livesElement.style.color = '#ff4444';
    } else if (simonLives === 2) {
        livesElement.style.color = '#ffaa00';
    } else {
        livesElement.style.color = '#4CAF50';
    }
}

// Mostrar mensaje en Sim√≥n
function showSimonMessage(message, type) {
    const messageElement = document.getElementById('simonMessage');
    messageElement.textContent = message;
    messageElement.className = `simon-message ${type}`;
}

// Actualizar barra de progreso
function updateProgressBar(percent, text) {
    const progressBar = document.getElementById('simonProgress');
    const progressText = document.getElementById('simonProgressText');
    
    if (progressBar) {
        progressBar.style.width = `${percent}%`;
        
        // Cambiar color seg√∫n el progreso
        if (percent < 30) {
            progressBar.style.backgroundColor = '#ff4444';
        } else if (percent < 70) {
            progressBar.style.backgroundColor = '#ffaa00';
        } else {
            progressBar.style.backgroundColor = '#4CAF50';
        }
    }
    
    if (progressText) {
        progressText.textContent = text;
    }
}

// Finalizar el juego Sim√≥n
function endSimonGame(isVictory) {
    simonGameActive = false;
    simonCanPlay = false;
    clearTimeout(simonTimer);
    
    // Actualizar puntuaci√≥n global
    score += Math.round(simonScore);
    updateDisplay();
    
    if (isVictory) {
        showSimonMessage(`üéâ ¬°VICTORIA INCRE√çBLE! Puntuaci√≥n final: ${Math.round(simonScore)}`, 'success');
        playVictorySound();
    } else {
        showSimonMessage(`üíÄ ¬°Game Over! Llegaste al nivel ${simonLevel}. Puntuaci√≥n: ${Math.round(simonScore)}`, 'error');
    }
    
    // Habilitar bot√≥n de comenzar
    document.getElementById('simonStartBtn').disabled = false;
    document.getElementById('simonHintBtn').disabled = true;
    document.getElementById('simonSpeedBtn').disabled = true;
    
    updateProgressBar(0, 'Juego terminado');
}

// Reproducir sonido de victoria
function playVictorySound() {
    console.log('¬°Sonido de victoria √©pica!');
}

// Detener juego Sim√≥n
function stopSimonGame() {
    simonGameActive = false;
    simonCanPlay = false;
    clearTimeout(simonTimer);
}

// Agregar estilos CSS para Sim√≥n Dice
function addSimonStyles() {
    if (document.getElementById('simon-styles')) return;
    
    const style = document.createElement('style');
    style.id = 'simon-styles';
    style.textContent = `
        .simon-game-container {
            text-align: center;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .simon-game-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .simon-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .simon-stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            text-align: center;
        }
        
        .simon-instructions {
            background: rgba(255, 215, 0, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FFD700;
            text-align: left;
        }
        
        .simon-instructions ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .simon-instructions li {
            margin: 5px 0;
            font-size: 0.9rem;
        }
        
        .simon-game-area {
            margin: 30px 0;
        }
        
        .simon-board {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 25px;
            border: 3px solid #FFD700;
        }
        
        .simon-button {
            position: relative;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 4px solid;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            user-select: none;
        }
        
        .simon-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
        }
        
        .simon-button:active {
            transform: scale(0.95);
        }
        
        .simon-emoji {
            font-size: 3rem;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));
        }
        
        .simon-glow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at center, transparent 30%, rgba(255,255,255,0.3) 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .simon-button:hover .simon-glow {
            opacity: 1;
        }
        
        .simon-display {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
        }
        
        .simon-message {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            min-height: 30px;
            padding: 15px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .simon-message.info {
            background: rgba(33, 150, 243, 0.2);
            color: #2196F3;
            border: 2px solid #2196F3;
        }
        
        .simon-message.success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }
        
        .simon-message.error {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 2px solid #f44336;
        }
        
        .simon-message.hint {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            border: 2px solid #FFD700;
        }
        
        .simon-message.bonus {
            background: rgba(156, 39, 176, 0.2);
            color: #E1BEE7;
            border: 2px solid #9C27B0;
            animation: pulse 1s infinite;
        }
        
        .simon-progress {
            margin-top: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: #4CAF50;
            border-radius: 10px;
            transition: width 0.3s ease, background-color 0.3s ease;
            width: 0%;
        }
        
        .progress-text {
            font-size: 0.9rem;
            color: #ccc;
        }
        
        .simon-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .simon-btn {
            background: linear-gradient(135deg, #c8102e, #a00d26);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 160px;
        }
        
        .simon-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(200, 16, 46, 0.4);
        }
        
        .simon-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .simon-achievements {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }
        
        .achievement-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .achievement-item {
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .achievement-item.achieved {
            background: rgba(76, 175, 80, 0.3);
            border-color: #4CAF50;
            color: #C8E6C9;
            animation: glow 2s infinite;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px #4CAF50; }
            50% { box-shadow: 0 0 20px #4CAF50; }
        }
        
        @media (max-width: 768px) {
            .simon-game-info {
                grid-template-columns: 1fr;
            }
            
            .simon-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .simon-board {
                max-width: 300px;
                gap: 15px;
            }
            
            .simon-button {
                width: 120px;
                height: 120px;
            }
            
            .simon-emoji {
                font-size: 2.5rem;
            }
            
            .simon-controls {
                gap: 10px;
            }
            
            .simon-btn {
                min-width: 140px;
                padding: 10px 15px;
            }
        }
        
        @media (max-width: 480px) {
            .simon-board {
                max-width: 250px;
            }
            
            .simon-button {
                width: 100px;
                height: 100px;
            }
            
            .simon-emoji {
                font-size: 2rem;
            }
        }
    `;
    document.head.appendChild(style);
}
            
// =============================================
// JUEGO "B√öSQUEDA NAVIDE√ëA" - SEARCH GAME
// =============================================

// Variables globales para el juego de b√∫squeda
let searchGameScore = 0;
let searchGameTimeLeft = 90;
let searchGameActive = false;
let searchGameTimer;
let foundItems = [];
let totalItems = 8;
let currentScene = 'livingRoom';

// Escenas y objetos para buscar
const searchScenes = {
    livingRoom: {
        name: 'Sala de Estar Navide√±a',
        background: 'https://images.unsplash.com/photo-1545558014-8692077e9b5c?w=600&h=400&fit=crop',
        items: [
            { id: 'ornament', name: 'Adorno de √Årbol', emoji: 'üî¥', x: 75, y: 30 },
            { id: 'sock', name: 'Calcet√≠n Navide√±o', emoji: 'üß¶', x: 15, y: 70 },
            { id: 'gift', name: 'Regalo', emoji: 'üéÅ', x: 60, y: 75 },
            { id: 'candy', name: 'Bast√≥n de Caramelo', emoji: 'üç¨', x: 85, y: 60 },
            { id: 'bell', name: 'Campana', emoji: 'üîî', x: 25, y: 40 },
            { id: 'star', name: 'Estrella', emoji: '‚≠ê', x: 45, y: 20 },
            { id: 'snowflake', name: 'Copo de Nieve', emoji: '‚ùÑÔ∏è', x: 70, y: 45 },
            { id: 'candle', name: 'Vela', emoji: 'üïØÔ∏è', x: 35, y: 55 }
        ]
    },
    kitchen: {
        name: 'Cocina Navide√±a',
        background: 'https://images.unsplash.com/photo-1544787219-7f47ccb76574?w=600&h=400&fit=crop',
        items: [
            { id: 'cookie', name: 'Galleta Navide√±a', emoji: 'üç™', x: 20, y: 35 },
            { id: 'cake', name: 'Pastel de Navidad', emoji: 'üç∞', x: 65, y: 40 },
            { id: 'hotchocolate', name: 'Chocolate Caliente', emoji: '‚òï', x: 80, y: 65 },
            { id: 'gingerbread', name: 'Hombre de Jengibre', emoji: 'üßë‚ÄçüéÑ', x: 40, y: 70 },
            { id: 'candycane', name: 'Bast√≥n Dulce', emoji: 'üéÄ', x: 55, y: 25 },
            { id: 'nutcracker', name: 'Cascanueces', emoji: 'ü•ú', x: 75, y: 30 },
            { id: 'plate', name: 'Plato de Galletas', emoji: 'üçΩÔ∏è', x: 30, y: 50 },
            { id: 'spoon', name: 'Cuchara de Madera', emoji: 'ü•Ñ', x: 85, y: 45 }
        ]
    },
    outside: {
        name: 'Exterior Nevado',
        background: 'https://images.unsplash.com/photo-1512389142860-9c449e58a543?w=600&h=400&fit=crop',
        items: [
            { id: 'snowman', name: 'Mu√±eco de Nieve', emoji: '‚õÑ', x: 25, y: 60 },
            { id: 'reindeer', name: 'Reno', emoji: 'ü¶å', x: 70, y: 35 },
            { id: 'sled', name: 'Trineo', emoji: 'üõ∑', x: 55, y: 70 },
            { id: 'snowball', name: 'Bola de Nieve', emoji: '‚ö™', x: 40, y: 45 },
            { id: 'icicle', name: 'Car√°mbano', emoji: 'üßä', x: 80, y: 25 },
            { id: 'mittens', name: 'Guantes', emoji: 'üß§', x: 15, y: 40 },
            { id: 'scarf', name: 'Bufanda', emoji: 'üß£', x: 65, y: 55 },
            { id: 'hat', name: 'Gorro Navide√±o', emoji: 'üé©', x: 35, y: 30 }
        ]
    }
};

// Funci√≥n para cargar el juego de b√∫squeda
function loadSearchGame() {
    gameArea.innerHTML = `
        <div class="search-game-container">
            <h3>üîç B√∫squeda Navide√±a</h3>
            <p>Encuentra todos los objetos escondidos en la escena antes de que se acabe el tiempo.</p>
            
            <div class="search-game-info">
                <div class="search-stats">
                    <div class="search-stat">
                        <span class="stat-label">Puntos:</span>
                        <span id="searchScore" class="stat-value">0</span>
                    </div>
                    <div class="search-stat">
                        <span class="stat-label">Tiempo:</span>
                        <span id="searchTime" class="stat-value">90s</span>
                    </div>
                    <div class="search-stat">
                        <span class="stat-label">Encontrados:</span>
                        <span id="searchFound" class="stat-value">0/8</span>
                    </div>
                </div>
                
                <div class="scene-selector">
                    <h4>üè† Selecciona una escena:</h4>
                    <div class="scene-options" id="sceneOptions"></div>
                </div>
                
                <div class="items-to-find">
                    <h4>üéØ Objetos a encontrar:</h4>
                    <div class="items-list" id="itemsList"></div>
                </div>
            </div>
            
            <div class="search-game-area">
                <div class="search-scene" id="searchScene">
                    <div class="scene-image" id="sceneImage"></div>
                    <div class="search-items" id="searchItems"></div>
                </div>
                
                <div class="search-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="searchProgress"></div>
                    </div>
                    <div class="progress-text" id="searchProgressText">¬°Encuentra todos los objetos!</div>
                </div>
            </div>
            
            <div class="search-controls">
                <button id="searchStartBtn" class="search-btn">üéØ Comenzar B√∫squeda</button>
                <button id="searchHintBtn" class="search-btn">üí° Pista</button>
                <button id="searchResetBtn" class="search-btn">üîÑ Reiniciar</button>
            </div>
            
            <div class="search-message" id="searchMessage"></div>
            
            <div class="search-tips">
                <h4>üí° Consejos:</h4>
                <ul>
                    <li>üîç Haz clic en cualquier √°rea de la imagen para buscar objetos</li>
                    <li>üéØ Los objetos est√°n bien escondidos - ¬°observa con atenci√≥n!</li>
                    <li>‚è∞ Gana puntos extra por encontrar objetos r√°pidamente</li>
                    <li>üåü ¬°Encuentra todos los objetos para ganar bonus!</li>
                </ul>
            </div>
        </div>
    `;
    
    initializeSearchGame();
    setupSearchGameEvents();
    renderSceneOptions();
    addSearchGameStyles();
}

// Inicializar el juego de b√∫squeda
function initializeSearchGame() {
    const sceneImage = document.getElementById('sceneImage');
    const searchItems = document.getElementById('searchItems');
    
    // Limpiar contenedores
    sceneImage.innerHTML = '';
    searchItems.innerHTML = '';
    foundItems = [];
    
    // Cargar escena actual
    loadCurrentScene();
    
    // Reiniciar variables del juego
    searchGameScore = 0;
    searchGameTimeLeft = 90;
    searchGameActive = false;
    
    updateSearchGameDisplay();
    showSearchMessage('¬°Selecciona una escena y presiona "Comenzar B√∫squeda"!', 'info');
}

// Cargar escena actual
function loadCurrentScene() {
    const scene = searchScenes[currentScene];
    const sceneImage = document.getElementById('sceneImage');
    const searchItems = document.getElementById('searchItems');
    
    // Establecer imagen de fondo
    sceneImage.style.backgroundImage = `url(${scene.background})`;
    
    // Crear elementos de b√∫squeda
    searchItems.innerHTML = '';
    scene.items.forEach(item => {
        const searchItem = document.createElement('div');
        searchItem.className = 'search-item';
        searchItem.dataset.id = item.id;
        searchItem.style.left = `${item.x}%`;
        searchItem.style.top = `${item.y}%`;
        searchItem.innerHTML = item.emoji;
        
        // Ocultar inicialmente
        searchItem.style.opacity = '0';
        
        searchItems.appendChild(searchItem);
    });
    
    // Actualizar lista de objetos a encontrar
    updateItemsList();
}

// Renderizar opciones de escena
function renderSceneOptions() {
    const sceneOptions = document.getElementById('sceneOptions');
    sceneOptions.innerHTML = '';
    
    Object.entries(searchScenes).forEach(([key, scene]) => {
        const option = document.createElement('div');
        option.className = `scene-option ${key === currentScene ? 'selected' : ''}`;
        option.dataset.scene = key;
        option.innerHTML = `
            <div class="scene-preview" style="background-image: url(${scene.background})"></div>
            <span class="scene-name">${scene.name}</span>
        `;
        
        option.addEventListener('click', () => selectSearchScene(key));
        sceneOptions.appendChild(option);
    });
}

// Seleccionar escena de b√∫squeda
function selectSearchScene(sceneKey) {
    if (searchGameActive) {
        showSearchMessage('Termina la b√∫squeda actual antes de cambiar de escena.', 'error');
        return;
    }
    
    currentScene = sceneKey;
    renderSceneOptions();
    loadCurrentScene();
    showSearchMessage(`Escena cambiada: ${searchScenes[sceneKey].name}`, 'info');
}

// Actualizar lista de objetos a encontrar
function updateItemsList() {
    const itemsList = document.getElementById('itemsList');
    const scene = searchScenes[currentScene];
    
    itemsList.innerHTML = '';
    scene.items.forEach(item => {
        const itemElement = document.createElement('div');
        itemElement.className = `item-to-find ${foundItems.includes(item.id) ? 'found' : ''}`;
        itemElement.innerHTML = `
            <span class="item-emoji">${item.emoji}</span>
            <span class="item-name">${item.name}</span>
            ${foundItems.includes(item.id) ? '<span class="found-check">‚úÖ</span>' : ''}
        `;
        itemsList.appendChild(itemElement);
    });
}

// Configurar eventos del juego de b√∫squeda
function setupSearchGameEvents() {
    const startBtn = document.getElementById('searchStartBtn');
    const hintBtn = document.getElementById('searchHintBtn');
    const resetBtn = document.getElementById('searchResetBtn');
    const searchScene = document.getElementById('searchScene');
    
    startBtn.addEventListener('click', startSearchGame);
    hintBtn.addEventListener('click', giveSearchHint);
    resetBtn.addEventListener('click', initializeSearchGame);
    
    // Evento para buscar objetos
    searchScene.addEventListener('click', handleSceneClick);
    
    // Deshabilitar botones hasta que empiece el juego
    hintBtn.disabled = true;
}

// Manejar clic en la escena
function handleSceneClick(event) {
    if (!searchGameActive) return;
    
    const scene = searchScenes[currentScene];
    const rect = event.currentTarget.getBoundingClientRect();
    const x = ((event.clientX - rect.left) / rect.width) * 100;
    const y = ((event.clientY - rect.top) / rect.height) * 100;
    
    // Verificar si se hizo clic cerca de alg√∫n objeto
    let foundObject = null;
    let minDistance = Infinity;
    
    scene.items.forEach(item => {
        if (!foundItems.includes(item.id)) {
            const distance = Math.sqrt(Math.pow(x - item.x, 2) + Math.pow(y - item.y, 2));
            
            // Radio de detecci√≥n (ajustable)
            if (distance < 8 && distance < minDistance) {
                minDistance = distance;
                foundObject = item;
            }
        }
    });
    
    if (foundObject) {
        // ¬°Objeto encontrado!
        foundItems.push(foundObject.id);
        
        // Mostrar objeto encontrado
        const foundElement = document.querySelector(`.search-item[data-id="${foundObject.id}"]`);
        if (foundElement) {
            foundElement.style.opacity = '1';
            foundElement.style.animation = 'foundItem 0.6s ease';
        }
        
        // Calcular puntos (m√°s puntos por encontrar r√°pido)
        const timeBonus = Math.max(10, Math.floor((searchGameTimeLeft / 90) * 50));
        const points = 20 + timeBonus;
        searchGameScore += points;
        
        showSearchMessage(`¬°Encontraste ${foundObject.emoji} ${foundObject.name}! +${points} puntos`, 'success');
        playSuccessSound();
        
        // Verificar si se encontraron todos los objetos
        if (foundItems.length === totalItems) {
            endSearchGame(true);
        }
        
        updateSearchGameDisplay();
        updateItemsList();
        updateProgressBar();
    } else {
        // No se encontr√≥ ning√∫n objeto
        showSearchMessage('Sigue buscando... ¬°est√°s cerca!', 'info');
    }
}

// Iniciar el juego de b√∫squeda
function startSearchGame() {
    if (searchGameActive) return;
    
    searchGameActive = true;
    document.getElementById('searchStartBtn').disabled = true;
    document.getElementById('searchHintBtn').disabled = false;
    
    startSearchTimer();
    showSearchMessage('¬°Tiempo de b√∫squeda! Encuentra todos los objetos ocultos.', 'success');
}

// Dar pista en la b√∫squeda
function giveSearchHint() {
    if (!searchGameActive) return;
    
    // Encontrar un objeto no encontrado
    const scene = searchScenes[currentScene];
    const remainingItems = scene.items.filter(item => !foundItems.includes(item.id));
    
    if (remainingItems.length > 0) {
        const randomItem = remainingItems[Math.floor(Math.random() * remainingItems.length)];
        
        // Mostrar √°rea aproximada con efecto visual
        const hintArea = document.createElement('div');
        hintArea.className = 'hint-area';
        hintArea.style.left = `${randomItem.x - 5}%`;
        hintArea.style.top = `${randomItem.y - 5}%`;
        
        document.getElementById('searchItems').appendChild(hintArea);
        
        // Peque√±a penalizaci√≥n por usar pista
        searchGameScore = Math.max(0, searchGameScore - 10);
        
        showSearchMessage(`üí° Pista: Busca cerca de esta √°rea. -10 puntos`, 'hint');
        updateSearchGameDisplay();
        
        // Remover hint despu√©s de 2 segundos
        setTimeout(() => {
            if (hintArea.parentNode) {
                hintArea.parentNode.removeChild(hintArea);
            }
        }, 2000);
    }
}

// Actualizar display del juego
function updateSearchGameDisplay() {
    document.getElementById('searchScore').textContent = searchGameScore;
    document.getElementById('searchTime').textContent = `${searchGameTimeLeft}s`;
    document.getElementById('searchFound').textContent = `${foundItems.length}/${totalItems}`;
    
    // Actualizar color del contador de encontrados
    const foundElement = document.getElementById('searchFound');
    if (foundItems.length === totalItems) {
        foundElement.style.color = '#4CAF50';
    } else if (foundItems.length >= totalItems / 2) {
        foundElement.style.color = '#FFD700';
    }
}

// Actualizar barra de progreso
function updateProgressBar() {
    const progress = (foundItems.length / totalItems) * 100;
    const progressBar = document.getElementById('searchProgress');
    const progressText = document.getElementById('searchProgressText');
    
    if (progressBar) {
        progressBar.style.width = `${progress}%`;
        
        // Cambiar color seg√∫n el progreso
        if (progress < 30) {
            progressBar.style.backgroundColor = '#ff4444';
        } else if (progress < 70) {
            progressBar.style.backgroundColor = '#ffaa00';
        } else {
            progressBar.style.backgroundColor = '#4CAF50';
        }
    }
    
    if (progressText) {
        progressText.textContent = `Progreso: ${foundItems.length}/${totalItems} objetos encontrados`;
    }
}

// Mostrar mensaje en el juego
function showSearchMessage(message, type) {
    const messageElement = document.getElementById('searchMessage');
    messageElement.textContent = message;
    messageElement.className = `search-message ${type}`;
    
    // Auto-ocultar mensajes informativos despu√©s de 3 segundos
    if (type === 'info' || type === 'hint') {
        setTimeout(() => {
            messageElement.className = 'search-message';
        }, 3000);
    }
}

// Iniciar temporizador del juego
function startSearchTimer() {
    clearInterval(searchGameTimer);
    searchGameTimer = setInterval(() => {
        if (searchGameActive) {
            searchGameTimeLeft--;
            updateSearchGameDisplay();
            
            if (searchGameTimeLeft <= 0) {
                endSearchGame(false);
            } else if (searchGameTimeLeft <= 10) {
                // Efecto de cuenta regresiva
                document.getElementById('searchTime').style.color = '#ff4444';
                document.getElementById('searchTime').style.animation = 'pulse 1s infinite';
            }
        }
    }, 1000);
}

// Finalizar el juego
function endSearchGame(isVictory) {
    searchGameActive = false;
    clearInterval(searchGameTimer);
    
    // Bonus por victoria
    if (isVictory) {
        const timeBonus = Math.floor((searchGameTimeLeft / 90) * 100);
        const perfectBonus = 50; // Bonus por encontrar todos los objetos
        searchGameScore += timeBonus + perfectBonus;
        
        showSearchMessage(
            `üéâ ¬°VICTORIA! Encontraste todos los objetos.\n` +
            `Bonus por tiempo: +${timeBonus} puntos\n` +
            `Bonus perfecto: +${perfectBonus} puntos\n` +
            `Puntuaci√≥n final: ${searchGameScore}`, 
            'success'
        );
        playVictorySound();
    } else {
        showSearchMessage(
            `‚è∞ ¬°Tiempo agotado!\n` +
            `Encontraste ${foundItems.length}/${totalItems} objetos\n` +
            `Puntuaci√≥n: ${searchGameScore}`, 
            'error'
        );
    }
    
    // Actualizar puntuaci√≥n global
    score += searchGameScore;
    updateDisplay();
    
    // Habilitar bot√≥n de comenzar
    document.getElementById('searchStartBtn').disabled = false;
    document.getElementById('searchHintBtn').disabled = true;
    
    updateSearchGameDisplay();
}

// Sonidos (simulados)
function playSuccessSound() {
    console.log('¬°Sonido de objeto encontrado!');
}

function playVictorySound() {
    console.log('¬°Sonido de victoria!');
}

// Detener juego de b√∫squeda
function stopSearchGame() {
    searchGameActive = false;
    clearInterval(searchGameTimer);
}

// Agregar estilos CSS para el juego de b√∫squeda
function addSearchGameStyles() {
    if (document.getElementById('search-game-styles')) return;
    
    const style = document.createElement('style');
    style.id = 'search-game-styles';
    style.textContent = `
        .search-game-container {
            text-align: center;
            padding: 20px;
            max-width: 900px;
            margin: 0 auto;
        }
        
        .search-game-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .search-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .search-stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 20px;
            border-radius: 15px;
            min-width: 100px;
        }
        
        .scene-selector, .items-to-find {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .scene-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .scene-option {
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            border-radius: 10px;
            overflow: hidden;
            width: 120px;
        }
        
        .scene-option:hover {
            transform: scale(1.05);
        }
        
        .scene-option.selected {
            border-color: #FFD700;
            box-shadow: 0 0 15px rgba(255,215,0,0.7);
        }
        
        .scene-preview {
            width: 100%;
            height: 80px;
            background-size: cover;
            background-position: center;
        }
        
        .scene-name {
            display: block;
            padding: 8px;
            font-size: 0.8rem;
            background: rgba(0,0,0,0.7);
        }
        
        .items-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-top: 10px;
        }
        
        .item-to-find {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .item-to-find.found {
            background: rgba(76, 175, 80, 0.3);
            color: #C8E6C9;
        }
        
        .item-emoji {
            font-size: 1.2rem;
        }
        
        .item-name {
            flex: 1;
            text-align: left;
            font-size: 0.85rem;
        }
        
        .found-check {
            color: #4CAF50;
        }
        
        .search-game-area {
            margin: 25px 0;
        }
        
        .search-scene {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 400px;
            margin: 0 auto;
            border-radius: 15px;
            overflow: hidden;
            border: 3px solid #FFD700;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            cursor: crosshair;
        }
        
        .scene-image {
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .search-items {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .search-item {
            position: absolute;
            font-size: 2rem;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.8));
            user-select: none;
            pointer-events: none;
        }
        
        .hint-area {
            position: absolute;
            width: 10%;
            height: 10%;
            border: 3px dashed #FFD700;
            border-radius: 50%;
            animation: pulseHint 2s infinite;
            pointer-events: none;
        }
        
        .search-progress {
            margin-top: 20px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: #4CAF50;
            border-radius: 10px;
            transition: width 0.3s ease, background-color 0.3s ease;
            width: 0%;
        }
        
        .progress-text {
            font-size: 0.9rem;
            color: #ccc;
        }
        
        .search-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .search-btn {
            background: linear-gradient(135deg, #c8102e, #a00d26);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 160px;
        }
        
        .search-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(200, 16, 46, 0.4);
        }
        
        .search-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .search-message {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
            white-space: pre-line;
            min-height: 20px;
            transition: all 0.3s ease;
        }
        
        .search-message.success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }
        
        .search-message.error {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 2px solid #f44336;
        }
        
        .search-message.info {
            background: rgba(33, 150, 243, 0.2);
            color: #2196F3;
            border: 2px solid #2196F3;
        }
        
        .search-message.hint {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            border: 2px solid #FFD700;
        }
        
        .search-tips {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: left;
        }
        
        .search-tips ul {
            list-style-type: none;
            padding-left: 0;
            margin-top: 15px;
        }
        
        .search-tips li {
            margin-bottom: 8px;
            padding-left: 25px;
            position: relative;
        }
        
        .search-tips li:before {
            content: "üéÑ";
            position: absolute;
            left: 0;
        }
        
        @keyframes foundItem {
            0% { 
                transform: translate(-50%, -50%) scale(0) rotate(-180deg); 
                opacity: 0;
            }
            70% { 
                transform: translate(-50%, -50%) scale(1.4) rotate(15deg); 
            }
            100% { 
                transform: translate(-50%, -50%) scale(1) rotate(0deg); 
                opacity: 1;
            }
        }
        
        @keyframes pulseHint {
            0%, 100% { 
                opacity: 0.7;
                transform: scale(1);
            }
            50% { 
                opacity: 0.3;
                transform: scale(1.1);
            }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        @media (max-width: 768px) {
            .search-game-info {
                grid-template-columns: 1fr;
            }
            
            .search-stats {
                flex-wrap: wrap;
            }
            
            .search-scene {
                height: 300px;
            }
            
            .scene-options {
                gap: 10px;
            }
            
            .scene-option {
                width: 100px;
            }
            
            .scene-preview {
                height: 60px;
            }
            
            .items-list {
                grid-template-columns: 1fr;
            }
            
            .search-controls {
                gap: 10px;
            }
            
            .search-btn {
                min-width: 140px;
                padding: 10px 15px;
            }
        }
    `;
    document.head.appendChild(style);
}
            
            function loadTossGame() {
                gameArea.innerHTML = `
                    <h3>Lanza los Regalos</h3>
                    <p>Haz clic y arrastra para ajustar la potencia y direcci√≥n</p>
                    <div class="toss-container">
                        <div class="chimney"></div>
                        <div class="gift" style="top: 50px; left: 100px;"></div>
                    </div>
                `;
            }
            
// =============================================
// JUEGO "CONECTA LOS PUNTOS" - CONNECT GAME
// =============================================

// Variables globales para el juego de conectar puntos
let connectGameScore = 0;
let connectGameTimeLeft = 120;
let connectGameActive = false;
let connectGameTimer;
let currentLevel = 1;
let currentPoints = [];
let connectedPoints = [];
let currentLine = null;
let isDrawing = false;
let lastConnectedPoint = null;

// Niveles del juego
const connectLevels = {
    1: {
        name: "√Årbol Navide√±o",
        points: 12,
        image: "üéÑ",
        pointsToWin: 10,
        time: 120,
        points: [
            { x: 50, y: 20, number: 1 },
            { x: 30, y: 35, number: 2 },
            { x: 70, y: 35, number: 3 },
            { x: 20, y: 50, number: 4 },
            { x: 50, y: 45, number: 5 },
            { x: 80, y: 50, number: 6 },
            { x: 15, y: 65, number: 7 },
            { x: 35, y: 60, number: 8 },
            { x: 65, y: 60, number: 9 },
            { x: 85, y: 65, number: 10 },
            { x: 50, y: 75, number: 11 },
            { x: 50, y: 90, number: 12 }
        ],
        connections: [
            [1, 2], [1, 3], [2, 4], [2, 5], [3, 5], [3, 6],
            [4, 7], [4, 8], [5, 8], [5, 9], [6, 9], [6, 10],
            [7, 8], [8, 9], [9, 10], [8, 11], [9, 11], [11, 12]
        ]
    },
    2: {
        name: "Estrella Navide√±a",
        points: 10,
        image: "‚≠ê",
        pointsToWin: 10,
        time: 100,
        points: [
            { x: 50, y: 20, number: 1 },
            { x: 35, y: 35, number: 2 },
            { x: 10, y: 45, number: 3 },   
            { x: 35, y: 55, number: 4 },
            { x: 25, y: 70, number: 5 },
            { x: 50, y: 65, number: 6 },
            { x: 75, y: 70, number: 7 },
            { x: 65, y: 55, number: 8 },
            { x: 90, y: 45, number: 9 },
            { x: 65, y: 35, number: 10 }
        ],
        connections: [
            [1, 2], [2, 3], [3, 4], [4, 5], [5, 6], [6, 7], [7, 8], [8, 9], [9, 10], [10, 1]
        ]
    },
    3: {
        name: "Reno Navide√±o",
        points: 15,
        image: "ü¶å",
        pointsToWin: 15,
        time: 150,
        points: [
            { x: 50, y: 15, number: 1 },
            { x: 40, y: 25, number: 2 },
            { x: 60, y: 25, number: 3 },
            { x: 30, y: 40, number: 4 },
            { x: 50, y: 35, number: 5 },
            { x: 70, y: 40, number: 6 },
            { x: 20, y: 55, number: 7 },
            { x: 40, y: 50, number: 8 },
            { x: 60, y: 50, number: 9 },
            { x: 80, y: 55, number: 10 },
            { x: 35, y: 65, number: 11 },
            { x: 50, y: 60, number: 12 },
            { x: 65, y: 65, number: 13 },
            { x: 45, y: 75, number: 14 },
            { x: 55, y: 75, number: 15 }
        ],
        connections: [
            [1, 2], [1, 3], [2, 4], [2, 5], [3, 5], [3, 6],
            [4, 7], [4, 8], [5, 8], [5, 9], [6, 9], [6, 10],
            [7, 8], [8, 9], [9, 10], [8, 11], [9, 13], [11, 12],
            [12, 13], [11, 14], [13, 15], [14, 15], [12, 14], [12, 15]
        ]
    }
};

// Funci√≥n para cargar el juego de conectar puntos
function loadConnectGame() {
    gameArea.innerHTML = `
        <div class="connect-game-container">
            <h3>‚úèÔ∏è Conecta los Puntos Navide√±os</h3>
            <p>¬°Conecta los puntos en orden num√©rico para revelar la imagen navide√±a oculta!</p>
            
            <div class="connect-game-info">
                <div class="connect-stats">
                    <div class="connect-stat">
                        <span class="stat-label">Puntos:</span>
                        <span id="connectScore" class="stat-value">0</span>
                    </div>
                    <div class="connect-stat">
                        <span class="stat-label">Tiempo:</span>
                        <span id="connectTime" class="stat-value">120s</span>
                    </div>
                    <div class="connect-stat">
                        <span class="stat-label">Nivel:</span>
                        <span id="connectLevel" class="stat-value">1</span>
                    </div>
                    <div class="connect-stat">
                        <span class="stat-label">Conectados:</span>
                        <span id="connectProgress" class="stat-value">0/0</span>
                    </div>
                    <div class="connect-stat">
                        <span class="stat-label">Imagen:</span>
                        <span id="connectImage" class="stat-value">üéÑ</span>
                    </div>
                </div>
                
                <div class="level-info">
                    <h4>üéØ Nivel Actual: <span id="levelName">√Årbol Navide√±o</span></h4>
                    <div class="level-instructions">
                        <p>Conecta los puntos del <strong>1</strong> al <strong id="maxPoint">12</strong> en orden para revelar la imagen</p>
                    </div>
                </div>
            </div>
            
            <div class="connect-game-area">
                <div class="canvas-container">
                    <div class="connect-canvas" id="connectCanvas">
                        <!-- L√≠neas y puntos se dibujar√°n aqu√≠ -->
                    </div>
                    <div class="preview-image" id="previewImage">
                        <span>?</span>
                    </div>
                </div>
                
                <div class="connect-controls-panel">
                    <div class="current-number">
                        <h4>üî¢ Pr√≥ximo N√∫mero:</h4>
                        <div class="number-display" id="nextNumber">1</div>
                    </div>
                    
                    <div class="connection-progress">
                        <h4>üìà Progreso:</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" id="connectionProgress"></div>
                        </div>
                        <div class="progress-text" id="connectionText">0% completado</div>
                    </div>
                    
                    <div class="hint-section">
                        <h4>üí° Ayudas:</h4>
                        <div class="hint-buttons">
                            <button id="showNumbers" class="hint-btn">üî¢ Mostrar N√∫meros</button>
                            <button id="showNext" class="hint-btn">üëâ Mostrar Siguiente</button>
                            <button id="autoConnect" class="hint-btn">ü§ñ Conexi√≥n Autom√°tica</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="connect-controls">
                <button id="connectStartBtn" class="connect-btn">üéØ Comenzar Juego</button>
                <button id="connectResetBtn" class="connect-btn">üîÑ Reiniciar Nivel</button>
                <button id="connectUndoBtn" class="connect-btn">‚Ü©Ô∏è Deshacer</button>
                <button id="connectNextBtn" class="connect-btn">‚û°Ô∏è Siguiente Nivel</button>
            </div>
            
            <div class="connect-message" id="connectMessage"></div>
            
            <div class="connect-tips">
                <h4>üéØ C√≥mo Jugar:</h4>
                <ul>
                    <li>‚úèÔ∏è Haz clic en los puntos en orden num√©rico (1, 2, 3...)</li>
                    <li>üîó Las l√≠neas se dibujar√°n autom√°ticamente entre puntos consecutivos</li>
                    <li>üé® ¬°Completa el dibujo para revelar la imagen navide√±a!</li>
                    <li>‚è∞ Completa antes de que se acabe el tiempo para bonus</li>
                    <li>üåü ¬°Usa las ayudas si te quedas atascado!</li>
                </ul>
            </div>
        </div>
    `;
    
    initializeConnectGame();
    setupConnectGameEvents();
    addConnectGameStyles();
}

// Inicializar el juego de conectar puntos
function initializeConnectGame() {
    const connectCanvas = document.getElementById('connectCanvas');
    
    // Limpiar canvas
    connectCanvas.innerHTML = '';
    
    // Reiniciar variables del juego
    connectGameScore = 0;
    connectGameTimeLeft = connectLevels[currentLevel].time;
    connectGameActive = false;
    connectedPoints = [];
    currentPoints = [];
    lastConnectedPoint = null;
    
    // Cargar nivel actual
    loadCurrentLevel();
    
    updateConnectGameDisplay();
    showConnectMessage('¬°Haz clic en "Comenzar Juego" para iniciar! Conecta los puntos en orden.', 'info');
}

// Cargar nivel actual
function loadCurrentLevel() {
    const level = connectLevels[currentLevel];
    const connectCanvas = document.getElementById('connectCanvas');
    const previewImage = document.getElementById('previewImage');
    
    // Limpiar canvas
    connectCanvas.innerHTML = '';
    
    // Actualizar informaci√≥n del nivel
    document.getElementById('levelName').textContent = level.name;
    document.getElementById('connectImage').textContent = level.image;
    document.getElementById('maxPoint').textContent = level.points;
    document.getElementById('nextNumber').textContent = '1';
    
    // Configurar imagen de preview
    previewImage.innerHTML = '<span>?</span>';
    previewImage.style.background = 'rgba(255,255,255,0.1)';
    
    // Crear puntos
    currentPoints = level.points;
    createPoints();
    
    // Actualizar progreso
    updateConnectionProgress();
}

// Crear puntos en el canvas
function createPoints() {
    const connectCanvas = document.getElementById('connectCanvas');
    
    currentPoints.forEach(point => {
        const pointElement = document.createElement('div');
        pointElement.className = 'connect-point';
        pointElement.dataset.number = point.number;
        pointElement.style.left = `${point.x}%`;
        pointElement.style.top = `${point.y}%`;
        pointElement.innerHTML = `
            <span class="point-number">${point.number}</span>
            <div class="point-circle"></div>
        `;
        
        pointElement.addEventListener('click', () => handlePointClick(point.number));
        connectCanvas.appendChild(pointElement);
    });
}

// Manejar clic en un punto
function handlePointClick(pointNumber) {
    if (!connectGameActive) return;
    
    const expectedNumber = connectedPoints.length + 1;
    
    if (pointNumber === expectedNumber) {
        // ¬°N√∫mero correcto!
        connectPoint(pointNumber);
    } else if (pointNumber === expectedNumber - 1 && lastConnectedPoint === pointNumber) {
        // Permitir hacer clic en el √∫ltimo punto conectado (para deshacer)
        showConnectMessage('Ya conectaste este punto. Haz clic en el siguiente n√∫mero.', 'info');
    } else {
        // N√∫mero incorrecto
        showConnectMessage(`¬°Ups! Debes conectar el n√∫mero ${expectedNumber} siguiente.`, 'error');
        playErrorSound();
    }
}

// Conectar un punto
function connectPoint(pointNumber) {
    const pointElement = document.querySelector(`.connect-point[data-number="${pointNumber}"]`);
    
    if (!pointElement) return;
    
    // Marcar punto como conectado
    pointElement.classList.add('connected');
    connectedPoints.push(pointNumber);
    lastConnectedPoint = pointNumber;
    
    // Dibujar l√≠nea si hay un punto anterior
    if (connectedPoints.length > 1) {
        const prevPointNumber = connectedPoints[connectedPoints.length - 2];
        drawLine(prevPointNumber, pointNumber);
    }
    
    // Calcular puntos ganados
    const pointsEarned = 2 + (currentLevel * 5);
    connectGameScore += pointsEarned;
    
    // Actualizar siguiente n√∫mero
    document.getElementById('nextNumber').textContent = connectedPoints.length + 1;
    
    // Verificar si se complet√≥ el nivel
    checkLevelCompletion();
    
    // Actualizar progreso
    updateConnectionProgress();
    
    showConnectMessage(`¬°Correcto! N√∫mero ${pointNumber} conectado. +${pointsEarned} puntos`, 'success');
    playSuccessSound();
}

// Dibujar l√≠nea entre dos puntos
function drawLine(fromPoint, toPoint) {
    const connectCanvas = document.getElementById('connectCanvas');
    const fromElement = document.querySelector(`.connect-point[data-number="${fromPoint}"]`);
    const toElement = document.querySelector(`.connect-point[data-number="${toPoint}"]`);
    
    if (!fromElement || !toElement) return;
    
    const fromRect = fromElement.getBoundingClientRect();
    const toRect = toElement.getBoundingClientRect();
    const canvasRect = connectCanvas.getBoundingClientRect();
    
    // Calcular posiciones relativas
    const fromX = fromRect.left + fromRect.width / 2 - canvasRect.left;
    const fromY = fromRect.top + fromRect.height / 2 - canvasRect.top;
    const toX = toRect.left + toRect.width / 2 - canvasRect.left;
    const toY = toRect.top + toRect.height / 2 - canvasRect.top;
    
    // Calcular longitud y √°ngulo
    const length = Math.sqrt(Math.pow(toX - fromX, 2) + Math.pow(toY - fromY, 2));
    const angle = Math.atan2(toY - fromY, toX - fromX) * 180 / Math.PI;
    
    // Crear elemento de l√≠nea
    const lineElement = document.createElement('div');
    lineElement.className = 'connection-line';
    lineElement.style.width = `${length}px`;
    lineElement.style.left = `${fromX}px`;
    lineElement.style.top = `${fromY}px`;
    lineElement.style.transform = `rotate(${angle}deg)`;
    lineElement.dataset.connection = `${fromPoint}-${toPoint}`;
    
    connectCanvas.appendChild(lineElement);
}

// Verificar completaci√≥n del nivel
function checkLevelCompletion() {
    const level = connectLevels[currentLevel];
    
    if (connectedPoints.length >= level.pointsToWin) {
        // ¬°Nivel completado!
        const timeBonus = Math.floor((connectGameTimeLeft / level.time) * 100);
        const perfectBonus = connectedPoints.length === level.points ? 50 : 0;
        const levelBonus = currentLevel * 30;
        
        connectGameScore += timeBonus + perfectBonus + levelBonus;
        
        // Revelar imagen completa
        revealImage();
        
        showConnectMessage(
            `üéâ ¬°Nivel ${currentLevel} Completado!\n` +
            `Bonus por tiempo: +${timeBonus} puntos\n` +
            `Bonus perfecto: +${perfectBonus} puntos\n` +
            `Bonus de nivel: +${levelBonus} puntos\n` +
            `Puntuaci√≥n total: ${connectGameScore}`,
            'success'
        );
        
        playVictorySound();
        
        // Deshabilitar juego hasta que avance al siguiente nivel
        connectGameActive = false;
        document.getElementById('connectNextBtn').disabled = false;
    }
}

// Revelar imagen completa
function revealImage() {
    const previewImage = document.getElementById('previewImage');
    const level = connectLevels[currentLevel];
    
    previewImage.innerHTML = `<span style="font-size: 4rem;">${level.image}</span>`;
    previewImage.style.background = 'rgba(255,215,0,0.2)';
    previewImage.style.borderColor = '#FFD700';
    
    // Dibujar todas las conexiones restantes
    const levelConnections = level.connections;
    levelConnections.forEach(connection => {
        const [from, to] = connection;
        if (!document.querySelector(`.connection-line[data-connection="${from}-${to}"]`) &&
            !document.querySelector(`.connection-line[data-connection="${to}-${from}"]`)) {
            drawLine(from, to);
        }
    });
}

// Actualizar progreso de conexi√≥n
function updateConnectionProgress() {
    const level = connectLevels[currentLevel];
    const progress = (connectedPoints.length / level.pointsToWin) * 100;
    const progressBar = document.getElementById('connectionProgress');
    const progressText = document.getElementById('connectionText');
    const connectProgress = document.getElementById('connectProgress');
    
    if (progressBar) {
        progressBar.style.width = `${progress}%`;
        
        // Cambiar color seg√∫n progreso
        if (progress < 30) {
            progressBar.style.background = '#ff4444';
        } else if (progress < 70) {
            progressBar.style.background = '#ffaa00';
        } else {
            progressBar.style.background = '#4CAF50';
        }
    }
    
    if (progressText) {
        progressText.textContent = `${Math.round(progress)}% completado`;
    }
    
    if (connectProgress) {
        connectProgress.textContent = `${connectedPoints.length}/${level.pointsToWin}`;
    }
}

// Configurar eventos del juego
function setupConnectGameEvents() {
    const startBtn = document.getElementById('connectStartBtn');
    const resetBtn = document.getElementById('connectResetBtn');
    const undoBtn = document.getElementById('connectUndoBtn');
    const nextBtn = document.getElementById('connectNextBtn');
    const showNumbersBtn = document.getElementById('showNumbers');
    const showNextBtn = document.getElementById('showNext');
    const autoConnectBtn = document.getElementById('autoConnect');
    
    startBtn.addEventListener('click', startConnectGame);
    resetBtn.addEventListener('click', initializeConnectGame);
    undoBtn.addEventListener('click', undoLastConnection);
    nextBtn.addEventListener('click', nextLevel);
    showNumbersBtn.addEventListener('click', toggleNumbers);
    showNextBtn.addEventListener('click', showNextPoint);
    autoConnectBtn.addEventListener('click', autoConnect);
    
    // Deshabilitar botones inicialmente
    undoBtn.disabled = true;
    nextBtn.disabled = true;
}

// Iniciar el juego
function startConnectGame() {
    if (connectGameActive) return;
    
    connectGameActive = true;
    document.getElementById('connectStartBtn').disabled = true;
    document.getElementById('connectUndoBtn').disabled = false;
    
    startConnectTimer();
    showConnectMessage('¬°Juego iniciado! Conecta los puntos en orden num√©rico.', 'success');
}

// Deshacer √∫ltima conexi√≥n
function undoLastConnection() {
    if (!connectGameActive || connectedPoints.length === 0) return;
    
    const lastPoint = connectedPoints.pop();
    const pointElement = document.querySelector(`.connect-point[data-number="${lastPoint}"]`);
    
    if (pointElement) {
        pointElement.classList.remove('connected');
    }
    
    // Remover √∫ltima l√≠nea
    const lines = document.querySelectorAll('.connection-line');
    if (lines.length > 0) {
        const lastLine = lines[lines.length - 1];
        lastLine.parentNode.removeChild(lastLine);
    }
    
    // Actualizar siguiente n√∫mero
    document.getElementById('nextNumber').textContent = connectedPoints.length + 1;
    lastConnectedPoint = connectedPoints.length > 0 ? connectedPoints[connectedPoints.length - 1] : null;
    
    // Penalizaci√≥n por deshacer
    connectGameScore = Math.max(0, connectGameScore - 5);
    
    updateConnectionProgress();
    updateConnectGameDisplay();
    showConnectMessage('√öltima conexi√≥n deshecha. -5 puntos', 'info');
}

// Siguiente nivel
function nextLevel() {
    if (currentLevel < Object.keys(connectLevels).length) {
        currentLevel++;
        initializeConnectGame();
        document.getElementById('connectNextBtn').disabled = true;
        document.getElementById('connectStartBtn').disabled = false;
    } else {
        endConnectGame(true);
    }
}

// Mostrar/ocultar n√∫meros
function toggleNumbers() {
    const points = document.querySelectorAll('.connect-point');
    const isVisible = points[0].classList.contains('numbers-visible');
    
    points.forEach(point => {
        if (isVisible) {
            point.classList.remove('numbers-visible');
        } else {
            point.classList.add('numbers-visible');
            // Penalizaci√≥n por usar ayuda
            connectGameScore = Math.max(0, connectGameScore - 10);
            updateConnectGameDisplay();
        }
    });
    
    showConnectMessage(isVisible ? 'N√∫meros ocultos' : 'N√∫meros mostrados. -10 puntos', 'info');
}

// Mostrar siguiente punto
function showNextPoint() {
    if (!connectGameActive) return;
    
    const nextNumber = connectedPoints.length + 1;
    const nextPoint = document.querySelector(`.connect-point[data-number="${nextNumber}"]`);
    
    if (nextPoint) {
        nextPoint.style.animation = 'pulse 1s ease-in-out 3';
        // Penalizaci√≥n por usar ayuda
        connectGameScore = Math.max(0, connectGameScore - 8);
        updateConnectGameDisplay();
        showConnectMessage(`¬°El siguiente punto es el n√∫mero ${nextNumber}! -8 puntos`, 'info');
    }
}

// Conexi√≥n autom√°tica
function autoConnect() {
    if (!connectGameActive) return;
    
    const nextNumber = connectedPoints.length + 1;
    const maxNumber = connectLevels[currentLevel].pointsToWin;
    
    let connected = 0;
    const autoConnectInterval = setInterval(() => {
        if (nextNumber + connected <= maxNumber && connectGameActive) {
            connectPoint(nextNumber + connected);
            connected++;
        } else {
            clearInterval(autoConnectInterval);
            // Penalizaci√≥n por usar ayuda
            const penalty = connected * 5;
            connectGameScore = Math.max(0, connectGameScore - penalty);
            updateConnectGameDisplay();
            showConnectMessage(`Conexi√≥n autom√°tica completada. -${penalty} puntos`, 'info');
        }
    }, 500);
}

// Iniciar temporizador
function startConnectTimer() {
    clearInterval(connectGameTimer);
    connectGameTimer = setInterval(() => {
        if (connectGameActive) {
            connectGameTimeLeft--;
            updateConnectGameDisplay();
            
            if (connectGameTimeLeft <= 0) {
                endConnectGame(false);
            } else if (connectGameTimeLeft <= 10) {
                document.getElementById('connectTime').style.color = '#ff4444';
                document.getElementById('connectTime').style.animation = 'pulse 1s infinite';
            }
        }
    }, 1000);
}

// Finalizar juego
function endConnectGame(isVictory) {
    connectGameActive = false;
    clearInterval(connectGameTimer);
    
    if (isVictory) {
        const victoryBonus = 100;
        connectGameScore += victoryBonus;
        
        showConnectMessage(
            `üéä ¬°VICTORIA TOTAL!\n` +
            `Completaste todos los niveles\n` +
            `Bonus de victoria: +${victoryBonus} puntos\n` +
            `Puntuaci√≥n final: ${connectGameScore}`,
            'success'
        );
        playVictorySound();
    } else {
        showConnectMessage(
            `‚è∞ ¬°Tiempo agotado!\n` +
            `Completaste ${connectedPoints.length} puntos\n` +
            `Puntuaci√≥n: ${connectGameScore}`,
            'error'
        );
    }
    
    // Actualizar puntuaci√≥n global
    score += connectGameScore;
    updateDisplay();
    
    // Habilitar botones
    document.getElementById('connectStartBtn').disabled = false;
}

// Actualizar display
function updateConnectGameDisplay() {
    document.getElementById('connectScore').textContent = connectGameScore;
    document.getElementById('connectTime').textContent = `${connectGameTimeLeft}s`;
    document.getElementById('connectLevel').textContent = currentLevel;
}

// Mostrar mensaje
function showConnectMessage(message, type) {
    const messageElement = document.getElementById('connectMessage');
    messageElement.textContent = message;
    messageElement.className = `connect-message ${type}`;
    
    if (type === 'info') {
        setTimeout(() => {
            messageElement.className = 'connect-message';
        }, 3000);
    }
}

// Sonidos (simulados)
function playSuccessSound() {
    console.log('¬°Sonido de conexi√≥n exitosa!');
}

function playErrorSound() {
    console.log('¬°Sonido de error!');
}

function playVictorySound() {
    console.log('¬°Sonido de victoria!');
}

// Detener juego
function stopConnectGame() {
    connectGameActive = false;
    clearInterval(connectGameTimer);
}

// Agregar estilos CSS
function addConnectGameStyles() {
    if (document.getElementById('connect-game-styles')) return;
    
    const style = document.createElement('style');
    style.id = 'connect-game-styles';
    style.textContent = `
        .connect-game-container {
            text-align: center;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .connect-game-info {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }
        
        .connect-stats {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .connect-stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-label {
            display: block;
            font-size: 0.9rem;
            color: #ccc;
            margin-bottom: 5px;
        }
        
        .stat-value {
            display: block;
            font-size: 1.3rem;
            font-weight: bold;
            color: #FFD700;
        }
        
        .level-info {
            background: rgba(255, 215, 0, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #FFD700;
        }
        
        .level-instructions {
            margin-top: 10px;
            font-size: 1rem;
        }
        
        .connect-game-area {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
            margin: 30px 0;
        }
        
        .canvas-container {
            position: relative;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            min-height: 500px;
        }
        
        .connect-canvas {
            position: relative;
            width: 100%;
            height: 100%;
            min-height: 450px;
        }
        
        .connect-point {
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .point-circle {
            width: 20px;
            height: 20px;
            background: #c8102e;
            border-radius: 50%;
            border: 3px solid #FFD700;
            transition: all 0.3s ease;
        }
        
        .point-number {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .connect-point.numbers-visible .point-number {
            opacity: 1;
        }
        
        .connect-point.connected .point-circle {
            background: #4CAF50;
            transform: scale(1.2);
        }
        
        .connect-point:hover .point-circle {
            transform: scale(1.3);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
        }
        
        .connection-line {
            position: absolute;
            height: 3px;
            background: #FFD700;
            transform-origin: 0 0;
            z-index: 5;
            pointer-events: none;
        }
        
        .preview-image {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 150px;
            height: 150px;
            border: 3px dashed rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            background: rgba(255, 255, 255, 0.05);
            transition: all 0.5s ease;
        }
        
        .connect-controls-panel {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }
        
        .current-number {
            margin-bottom: 25px;
        }
        
        .number-display {
            font-size: 3rem;
            font-weight: bold;
            color: #FFD700;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 10px;
        }
        
        .connection-progress {
            margin-bottom: 25px;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: #4CAF50;
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        .progress-text {
            font-size: 0.9rem;
            color: #ccc;
        }
        
        .hint-section {
            margin-top: 25px;
        }
        
        .hint-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }
        
        .hint-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid #FFD700;
            padding: 10px 15px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .hint-btn:hover {
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
        }
        
        .connect-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .connect-btn {
            background: linear-gradient(135deg, #c8102e, #a00d26);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 160px;
        }
        
        .connect-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(200, 16, 46, 0.4);
        }
        
        .connect-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .connect-message {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-weight: bold;
            white-space: pre-line;
            min-height: 20px;
            transition: all 0.3s ease;
        }
        
        .connect-message.success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 2px solid #4CAF50;
        }
        
        .connect-message.error {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 2px solid #f44336;
        }
        
        .connect-message.info {
            background: rgba(33, 150, 243, 0.2);
            color: #2196F3;
            border: 2px solid #2196F3;
        }
        
        .connect-tips {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            text-align: left;
        }
        
        .connect-tips ul {
            list-style-type: none;
            padding-left: 0;
            margin-top: 15px;
        }
        
        .connect-tips li {
            margin-bottom: 8px;
            padding-left: 25px;
            position: relative;
        }
        
        .connect-tips li:before {
            content: "üéÑ";
            position: absolute;
            left: 0;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        @media (max-width: 900px) {
            .connect-game-area {
                grid-template-columns: 1fr;
            }
            
            .connect-stats {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .canvas-container {
                min-height: 400px;
            }
            
            .connect-canvas {
                min-height: 350px;
            }
        }
        
        @media (max-width: 600px) {
            .connect-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .connect-controls {
                gap: 10px;
            }
            
            .connect-btn {
                min-width: 140px;
                padding: 10px 15px;
            }
            
            .canvas-container {
                min-height: 300px;
            }
            
            .connect-canvas {
                min-height: 250px;
            }
        }
    `;
    document.head.appendChild(style);
}
            
            function loadBreakGame() {
                gameArea.innerHTML = `<h3>Rompe los Adornos</h3><p>Usa las teclas para mover la plataforma y romper los adornos</p>`;
            }
            
            function loadSocksGame() {
                gameArea.innerHTML = `<h3>Empareja los Calcetines</h3><p>Encuentra los pares de calcetines iguales</p>`;
            }
            
            function loadCarolsGame() {
                gameArea.innerHTML = `<h3>Canto de Villancicos</h3><p>Presiona las teclas en el momento correcto para seguir la melod√≠a</p>`;
            }
            
            // Inicializar display
            updateDisplay();
        });
    </script>
    <!-- Footer -->
    <div id="footer"></div>
<script src="preloader.js"></script>
</body>
</html>
